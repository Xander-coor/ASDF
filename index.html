<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2025-08-27-10-11-39.xlsx</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
  <style>
    html, body { height:100%; margin:0; background:#fff; }
    #map { position:absolute; top:0; left:0; right:0; bottom:28vh; }
    #profile-wrap{ position:fixed; left:0; right:0; bottom:0; height:28vh; background:#fff;
                    box-shadow:0 -2px 10px rgba(0,0,0,.15); z-index:9999; }
    #profile-head{ display:flex; justify-content:space-between; align-items:center; padding:6px 12px;
                    font:14px/1.4 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC',Arial,'Helvetica Neue',sans-serif;
                    border-bottom:1px solid #eee }
    #profile-chart{ height:calc(28vh - 40px); padding:8px 12px }
    #profile-chart canvas{ width:100%; height:100% }
    #side-info{
      position:fixed; right:12px; top:12px; width:300px;
      background:rgba(255,255,255,.97); padding:10px 12px;
      border:1px solid #ddd; border-radius:10px;
      box-shadow:0 2px 10px rgba(0,0,0,.12); z-index:10050; pointer-events:none;
      font:13px/1.45 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC',Arial,'Helvetica Neue',sans-serif;
      max-height:60vh; overflow:auto;
    }
    .kv{ display:flex; gap:6px } .k{ min-width:88px; color:#666 } .v{ flex:1 }
  </style>
</head>
<body>
  <div id="map"></div>

  <div id="side-info">
    <div style="font-weight:600; margin-bottom:6px;">資料資訊</div>
    <div class="kv"><div class="k">Time</div><div class="v" id="v_time">2025-08-27 10:11:39</div></div>
    <div class="kv"><div class="k">Elevation (m)</div><div class="v" id="v_elev">205.8</div></div>
    <div class="kv"><div class="k">Power (W)</div><div class="v" id="v_power">48.0</div></div>
    <div class="kv"><div class="k">Cadence1 (rpm)</div><div class="v" id="v_cad1">60.0</div></div>
    <div class="kv"><div class="k">Speed (km/h)</div><div class="v" id="v_speed">16.23</div></div>
    <div class="kv"><div class="k">Gradient (%)</div><div class="v" id="v_grad">None</div></div>
    <div class="kv"><div class="k">Distance</div><div class="v" id="v_dist">0 m (0.0 km)</div></div>
    <div class="kv"><div class="k">Motor</div><div class="v" id="v_motor">68</div></div>
    <div class="kv"><div class="k">Main ib</div><div class="v" id="v_mainib">8700</div></div>
    <div class="kv"><div class="k">Torque (Nm)</div><div class="v" id="v_torque">0.0</div></div>
    <div class="kv"><div class="k">Cadence2 (rpm)</div><div class="v" id="v_cad2">0.0</div></div>
    <div class="kv"><div class="k">Level</div><div class="v" id="v_level">3.0</div></div>
  </div>

  <div id="profile-wrap">
    <div id="profile-head">
      <div id="profile-title">剖面圖</div>
      <div id="profile-legend" style="opacity:.8">Elevation vs Distance</div>
    </div>
    <div id="profile-chart"><canvas id="elevCanvas"></canvas></div>
  </div>

<script>
const POINTS = [{"_lat": 24.200394, "_lon": 120.583984, "dist_km": 0.0, "_elev": 205.8, "time": "2025-08-27 10:11:39", "elevation": 205.8, "power": 48.0, "cadence1": 60.0, "cadence2": 0.0, "speed": 16.23, "gradient": null, "distance": 0.0, "motor": "68", "main_ib": "8700", "torque": 0.0, "level": 3.0}, {"_lat": 24.200431, "_lon": 120.583983, "dist_km": 0.004, "_elev": 205.6, "time": "2025-08-27 10:11:40", "elevation": 205.6, "power": 0.0, "cadence1": 60.0, "cadence2": 0.0, "speed": 16.56, "gradient": -4.86, "distance": 4.0, "motor": "67", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200464, "_lon": 120.583998, "dist_km": 0.008, "_elev": 205.2, "time": "2025-08-27 10:11:41", "elevation": 205.2, "power": 0.0, "cadence1": 60.0, "cadence2": 15.0, "speed": 16.36, "gradient": -10.07, "distance": 8.0, "motor": "67", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200494, "_lon": 120.584039, "dist_km": 0.013, "_elev": 205.0, "time": "2025-08-27 10:11:42", "elevation": 205.0, "power": 0.0, "cadence1": 0.0, "cadence2": 52.0, "speed": 17.47, "gradient": -3.75, "distance": 13.0, "motor": "68", "main_ib": "18900", "torque": 0.4, "level": 3.0}, {"_lat": 24.200502, "_lon": 120.584101, "dist_km": 0.019, "_elev": 204.8, "time": "2025-08-27 10:11:43", "elevation": 204.8, "power": 0.0, "cadence1": 0.0, "cadence2": 1.0, "speed": 20.22, "gradient": -3.15, "distance": 19.0, "motor": "68", "main_ib": "19000", "torque": 0.25, "level": 3.0}, {"_lat": 24.200485, "_lon": 120.584142, "dist_km": 0.024, "_elev": 204.8, "time": "2025-08-27 10:11:44", "elevation": 204.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 14.88, "gradient": 0.0, "distance": 24.0, "motor": "68", "main_ib": "18900", "torque": 0.15, "level": 3.0}, {"_lat": 24.200463, "_lon": 120.584177, "dist_km": 0.028, "_elev": 204.6, "time": "2025-08-27 10:11:45", "elevation": 204.6, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 14.88, "gradient": -4.64, "distance": 28.0, "motor": "70", "main_ib": "18900", "torque": 0.2, "level": 3.0}, {"_lat": 24.200444, "_lon": 120.584209, "dist_km": 0.032, "_elev": 204.8, "time": "2025-08-27 10:11:46", "elevation": 204.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 13.47, "gradient": 5.16, "distance": 32.0, "motor": "70", "main_ib": "19000", "torque": 0.15000000000000002, "level": 3.0}, {"_lat": 24.200433, "_lon": 120.58424, "dist_km": 0.035, "_elev": 205.0, "time": "2025-08-27 10:11:47", "elevation": 205.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 12.06, "gradient": 5.93, "distance": 35.0, "motor": "71", "main_ib": "18900", "torque": 0.25, "level": 3.0}, {"_lat": 24.200423, "_lon": 120.584266, "dist_km": 0.038, "_elev": 205.4, "time": "2025-08-27 10:11:48", "elevation": 205.4, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.68, "gradient": 13.98, "distance": 38.0, "motor": "72", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200416, "_lon": 120.584294, "dist_km": 0.041, "_elev": 205.8, "time": "2025-08-27 10:11:49", "elevation": 205.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.11, "gradient": 13.58, "distance": 41.0, "motor": "73", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200413, "_lon": 120.584321, "dist_km": 0.044, "_elev": 206.2, "time": "2025-08-27 10:11:50", "elevation": 206.2, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.57, "gradient": 14.5, "distance": 44.0, "motor": "74", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200407, "_lon": 120.584345, "dist_km": 0.046, "_elev": 206.6, "time": "2025-08-27 10:11:51", "elevation": 206.6, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.47, "gradient": 15.85, "distance": 46.0, "motor": "76", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.2004, "_lon": 120.584372, "dist_km": 0.049, "_elev": 207.0, "time": "2025-08-27 10:11:52", "elevation": 207.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.61, "gradient": 14.05, "distance": 49.0, "motor": "77", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200394, "_lon": 120.584399, "dist_km": 0.052, "_elev": 207.4, "time": "2025-08-27 10:11:53", "elevation": 207.4, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.08, "gradient": 14.19, "distance": 52.0, "motor": "78", "main_ib": "19100", "torque": 0.05, "level": 3.0}, {"_lat": 24.200388, "_lon": 120.584424, "dist_km": 0.055, "_elev": 207.8, "time": "2025-08-27 10:11:54", "elevation": 207.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.68, "gradient": 15.26, "distance": 55.0, "motor": "80", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200382, "_lon": 120.58445, "dist_km": 0.057, "_elev": 208.0, "time": "2025-08-27 10:11:55", "elevation": 208.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.65, "gradient": 7.35, "distance": 57.0, "motor": "81", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200377, "_lon": 120.584476, "dist_km": 0.06, "_elev": 208.4, "time": "2025-08-27 10:11:56", "elevation": 208.4, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.52, "gradient": 14.84, "distance": 60.0, "motor": "82", "main_ib": "19000", "torque": 0.05, "level": 3.0}, {"_lat": 24.200371, "_lon": 120.584504, "dist_km": 0.063, "_elev": 208.6, "time": "2025-08-27 10:11:57", "elevation": 208.6, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 10.25, "gradient": 6.86, "distance": 63.0, "motor": "84", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200365, "_lon": 120.584535, "dist_km": 0.066, "_elev": 208.8, "time": "2025-08-27 10:11:58", "elevation": 208.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.77, "gradient": 6.22, "distance": 66.0, "motor": "85", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200357, "_lon": 120.584563, "dist_km": 0.069, "_elev": 209.0, "time": "2025-08-27 10:11:59", "elevation": 209.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.24, "gradient": 6.72, "distance": 69.0, "motor": "87", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200348, "_lon": 120.584589, "dist_km": 0.072, "_elev": 209.8, "time": "2025-08-27 10:12:00", "elevation": 209.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.74, "gradient": 28.36, "distance": 72.0, "motor": "88", "main_ib": "18900", "torque": 0.05, "level": 3.0}, {"_lat": 24.200339, "_lon": 120.584607, "dist_km": 0.074, "_elev": 210.8, "time": "2025-08-27 10:12:01", "elevation": 210.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.57, "gradient": 48.03, "distance": 74.0, "motor": "90", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200325, "_lon": 120.584626, "dist_km": 0.076, "_elev": 211.0, "time": "2025-08-27 10:12:02", "elevation": 211.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.41, "gradient": 8.07, "distance": 76.0, "motor": "91", "main_ib": "19100", "torque": 0.0, "level": 3.0}, {"_lat": 24.200311, "_lon": 120.584645, "dist_km": 0.079, "_elev": 211.2, "time": "2025-08-27 10:12:03", "elevation": 211.2, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.7, "gradient": 8.07, "distance": 79.0, "motor": "93", "main_ib": "19000", "torque": 0.1, "level": 3.0}, {"_lat": 24.200299, "_lon": 120.584664, "dist_km": 0.081, "_elev": 211.2, "time": "2025-08-27 10:12:04", "elevation": 211.2, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.56, "gradient": 0.0, "distance": 81.0, "motor": "94", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200288, "_lon": 120.584681, "dist_km": 0.083, "_elev": 211.4, "time": "2025-08-27 10:12:05", "elevation": 211.4, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.53, "gradient": 9.46, "distance": 83.0, "motor": "96", "main_ib": "18900", "torque": 0.1, "level": 3.0}, {"_lat": 24.200277, "_lon": 120.5847, "dist_km": 0.086, "_elev": 211.8, "time": "2025-08-27 10:12:06", "elevation": 211.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.9, "gradient": 17.53, "distance": 86.0, "motor": "98", "main_ib": "19100", "torque": 0.0, "level": 3.0}, {"_lat": 24.200265, "_lon": 120.584717, "dist_km": 0.088, "_elev": 211.8, "time": "2025-08-27 10:12:07", "elevation": 211.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.83, "gradient": 0.0, "distance": 88.0, "motor": "100", "main_ib": "18900", "torque": 0.05, "level": 3.0}, {"_lat": 24.200255, "_lon": 120.584735, "dist_km": 0.09, "_elev": 212.2, "time": "2025-08-27 10:12:08", "elevation": 212.2, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.21, "gradient": 18.71, "distance": 90.0, "motor": "101", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200242, "_lon": 120.584756, "dist_km": 0.092, "_elev": 212.4, "time": "2025-08-27 10:12:09", "elevation": 212.4, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.14, "gradient": 7.77, "distance": 92.0, "motor": "103", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200229, "_lon": 120.58478, "dist_km": 0.095, "_elev": 212.6, "time": "2025-08-27 10:12:10", "elevation": 212.6, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.31, "gradient": 7.06, "distance": 95.0, "motor": "104", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200215, "_lon": 120.584802, "dist_km": 0.098, "_elev": 212.8, "time": "2025-08-27 10:12:11", "elevation": 212.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.44, "gradient": 7.35, "distance": 98.0, "motor": "106", "main_ib": "18900", "torque": 0.05, "level": 3.0}, {"_lat": 24.200203, "_lon": 120.58482, "dist_km": 0.1, "_elev": 212.8, "time": "2025-08-27 10:12:12", "elevation": 212.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.1, "gradient": 0.0, "distance": 100.0, "motor": "108", "main_ib": "18900", "torque": 0.05, "level": 3.0}, {"_lat": 24.200188, "_lon": 120.58484, "dist_km": 0.103, "_elev": 213.2, "time": "2025-08-27 10:12:13", "elevation": 213.2, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.97, "gradient": 15.23, "distance": 103.0, "motor": "110", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200175, "_lon": 120.584861, "dist_km": 0.106, "_elev": 213.4, "time": "2025-08-27 10:12:14", "elevation": 213.4, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 8.94, "gradient": 7.77, "distance": 106.0, "motor": "111", "main_ib": "18800", "torque": 0.0, "level": 3.0}, {"_lat": 24.200161, "_lon": 120.58488, "dist_km": 0.108, "_elev": 213.8, "time": "2025-08-27 10:12:15", "elevation": 213.8, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.21, "gradient": 16.15, "distance": 108.0, "motor": "113", "main_ib": "17000", "torque": 0.0, "level": 3.0}, {"_lat": 24.20015, "_lon": 120.584902, "dist_km": 0.111, "_elev": 214.0, "time": "2025-08-27 10:12:16", "elevation": 214.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 9.47, "gradient": 7.86, "distance": 111.0, "motor": "115", "main_ib": "15000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200139, "_lon": 120.584925, "dist_km": 0.113, "_elev": 214.2, "time": "2025-08-27 10:12:17", "elevation": 214.2, "power": 0.0, "cadence1": 0.0, "cadence2": 37.0, "speed": 9.61, "gradient": 7.59, "distance": 113.0, "motor": "116", "main_ib": "13100", "torque": 12.35, "level": 3.0}, {"_lat": 24.200129, "_lon": 120.584946, "dist_km": 0.116, "_elev": 214.4, "time": "2025-08-27 10:12:18", "elevation": 214.4, "power": 0.0, "cadence1": 0.0, "cadence2": 45.0, "speed": 9.37, "gradient": 8.32, "distance": 116.0, "motor": "114", "main_ib": "10700", "torque": 65.25, "level": 3.0}, {"_lat": 24.200117, "_lon": 120.584962, "dist_km": 0.118, "_elev": 214.6, "time": "2025-08-27 10:12:19", "elevation": 214.6, "power": 0.0, "cadence1": 0.0, "cadence2": 56.0, "speed": 9.0, "gradient": 9.52, "distance": 118.0, "motor": "116", "main_ib": "18000", "torque": 25.549999999999997, "level": 3.0}, {"_lat": 24.200104, "_lon": 120.584977, "dist_km": 0.12, "_elev": 214.8, "time": "2025-08-27 10:12:20", "elevation": 214.8, "power": 0.0, "cadence1": 0.0, "cadence2": 64.0, "speed": 8.13, "gradient": 9.53, "distance": 120.0, "motor": "118", "main_ib": "18000", "torque": 31.200000000000003, "level": 3.0}, {"_lat": 24.200089, "_lon": 120.584998, "dist_km": 0.122, "_elev": 215.0, "time": "2025-08-27 10:12:21", "elevation": 215.0, "power": 0.0, "cadence1": 48.0, "cadence2": 69.0, "speed": 9.64, "gradient": 7.39, "distance": 122.0, "motor": "118", "main_ib": "17900", "torque": 48.400000000000006, "level": 3.0}, {"_lat": 24.20007, "_lon": 120.585023, "dist_km": 0.126, "_elev": 215.4, "time": "2025-08-27 10:12:22", "elevation": 215.4, "power": 348.0, "cadence1": 61.0, "cadence2": 72.0, "speed": 11.69, "gradient": 12.12, "distance": 126.0, "motor": "121", "main_ib": "17900", "torque": 17.85, "level": 3.0}, {"_lat": 24.200052, "_lon": 120.585053, "dist_km": 0.129, "_elev": 215.6, "time": "2025-08-27 10:12:23", "elevation": 215.6, "power": 309.0, "cadence1": 66.0, "cadence2": 75.0, "speed": 12.73, "gradient": 5.49, "distance": 129.0, "motor": "122", "main_ib": "18000", "torque": 22.65, "level": 3.0}, {"_lat": 24.200031, "_lon": 120.585083, "dist_km": 0.133, "_elev": 215.8, "time": "2025-08-27 10:12:24", "elevation": 215.8, "power": 295.0, "cadence1": 71.0, "cadence2": 77.0, "speed": 13.71, "gradient": 5.21, "distance": 133.0, "motor": "124", "main_ib": "16400", "torque": 10.9, "level": 3.0}, {"_lat": 24.200007, "_lon": 120.585114, "dist_km": 0.137, "_elev": 216.0, "time": "2025-08-27 10:12:25", "elevation": 216.0, "power": 286.0, "cadence1": 73.0, "cadence2": 76.0, "speed": 14.54, "gradient": 4.85, "distance": 137.0, "motor": "124", "main_ib": "15900", "torque": 30.85, "level": 3.0}, {"_lat": 24.199981, "_lon": 120.585139, "dist_km": 0.141, "_elev": 216.2, "time": "2025-08-27 10:12:26", "elevation": 216.2, "power": 253.0, "cadence1": 78.0, "cadence2": 76.0, "speed": 15.12, "gradient": 5.2, "distance": 141.0, "motor": "125", "main_ib": "18000", "torque": 12.600000000000001, "level": 3.0}, {"_lat": 24.199955, "_lon": 120.585168, "dist_km": 0.145, "_elev": 216.6, "time": "2025-08-27 10:12:27", "elevation": 216.6, "power": 241.0, "cadence1": 78.0, "cadence2": 76.0, "speed": 14.91, "gradient": 9.7, "distance": 145.0, "motor": "126", "main_ib": "17500", "torque": 23.950000000000003, "level": 3.0}, {"_lat": 24.199929, "_lon": 120.585197, "dist_km": 0.149, "_elev": 216.8, "time": "2025-08-27 10:12:28", "elevation": 216.8, "power": 249.0, "cadence1": 75.0, "cadence2": 77.0, "speed": 14.71, "gradient": 4.85, "distance": 149.0, "motor": "126", "main_ib": "16700", "torque": 19.35, "level": 3.0}, {"_lat": 24.199905, "_lon": 120.585229, "dist_km": 0.154, "_elev": 217.2, "time": "2025-08-27 10:12:29", "elevation": 217.2, "power": 239.0, "cadence1": 78.0, "cadence2": 77.0, "speed": 14.78, "gradient": 9.52, "distance": 154.0, "motor": "127", "main_ib": "17900", "torque": 20.450000000000003, "level": 3.0}, {"_lat": 24.199884, "_lon": 120.585263, "dist_km": 0.158, "_elev": 217.6, "time": "2025-08-27 10:12:30", "elevation": 217.6, "power": 265.0, "cadence1": 78.0, "cadence2": 78.0, "speed": 14.81, "gradient": 9.6, "distance": 158.0, "motor": "128", "main_ib": "18000", "torque": 33.099999999999994, "level": 3.0}, {"_lat": 24.199862, "_lon": 120.585297, "dist_km": 0.162, "_elev": 218.0, "time": "2025-08-27 10:12:31", "elevation": 218.0, "power": 260.0, "cadence1": 76.0, "cadence2": 80.0, "speed": 14.88, "gradient": 9.46, "distance": 162.0, "motor": "128", "main_ib": "17900", "torque": 18.95, "level": 3.0}, {"_lat": 24.199844, "_lon": 120.585333, "dist_km": 0.166, "_elev": 218.4, "time": "2025-08-27 10:12:32", "elevation": 218.4, "power": 290.0, "cadence1": 79.0, "cadence2": 80.0, "speed": 15.08, "gradient": 9.61, "distance": 166.0, "motor": "129", "main_ib": "17900", "torque": 23.05, "level": 3.0}, {"_lat": 24.199826, "_lon": 120.585371, "dist_km": 0.171, "_elev": 218.8, "time": "2025-08-27 10:12:33", "elevation": 218.8, "power": 281.0, "cadence1": 80.0, "cadence2": 80.0, "speed": 15.48, "gradient": 9.21, "distance": 171.0, "motor": "130", "main_ib": "18000", "torque": 30.6, "level": 3.0}, {"_lat": 24.199807, "_lon": 120.585405, "dist_km": 0.174, "_elev": 219.2, "time": "2025-08-27 10:12:34", "elevation": 219.2, "power": 303.0, "cadence1": 80.0, "cadence2": 79.0, "speed": 15.58, "gradient": 9.89, "distance": 174.0, "motor": "132", "main_ib": "17200", "torque": 16.7, "level": 3.0}, {"_lat": 24.199788, "_lon": 120.585443, "dist_km": 0.179, "_elev": 219.6, "time": "2025-08-27 10:12:35", "elevation": 219.6, "power": 298.0, "cadence1": 81.0, "cadence2": 80.0, "speed": 15.45, "gradient": 9.1, "distance": 179.0, "motor": "132", "main_ib": "16900", "torque": 13.45, "level": 3.0}, {"_lat": 24.199767, "_lon": 120.585479, "dist_km": 0.183, "_elev": 220.0, "time": "2025-08-27 10:12:36", "elevation": 220.0, "power": 254.0, "cadence1": 80.0, "cadence2": 79.0, "speed": 15.48, "gradient": 9.23, "distance": 183.0, "motor": "132", "main_ib": "15900", "torque": 30.25, "level": 3.0}, {"_lat": 24.199745, "_lon": 120.585518, "dist_km": 0.188, "_elev": 220.4, "time": "2025-08-27 10:12:37", "elevation": 220.4, "power": 272.0, "cadence1": 80.0, "cadence2": 78.0, "speed": 15.62, "gradient": 8.6, "distance": 188.0, "motor": "132", "main_ib": "14900", "torque": 23.0, "level": 3.0}, {"_lat": 24.199729, "_lon": 120.585555, "dist_km": 0.192, "_elev": 220.8, "time": "2025-08-27 10:12:38", "elevation": 220.8, "power": 272.0, "cadence1": 80.0, "cadence2": 82.0, "speed": 15.58, "gradient": 9.63, "distance": 192.0, "motor": "133", "main_ib": "14100", "torque": 20.0, "level": 3.0}, {"_lat": 24.199713, "_lon": 120.585592, "dist_km": 0.196, "_elev": 221.0, "time": "2025-08-27 10:12:39", "elevation": 221.0, "power": 256.0, "cadence1": 78.0, "cadence2": 83.0, "speed": 15.18, "gradient": 4.82, "distance": 196.0, "motor": "134", "main_ib": "13500", "torque": 19.55, "level": 3.0}, {"_lat": 24.199696, "_lon": 120.585633, "dist_km": 0.2, "_elev": 221.4, "time": "2025-08-27 10:12:40", "elevation": 221.4, "power": 265.0, "cadence1": 83.0, "cadence2": 79.0, "speed": 15.55, "gradient": 8.76, "distance": 200.0, "motor": "134", "main_ib": "13400", "torque": 28.25, "level": 3.0}, {"_lat": 24.199677, "_lon": 120.585671, "dist_km": 0.205, "_elev": 221.8, "time": "2025-08-27 10:12:41", "elevation": 221.8, "power": 278.0, "cadence1": 84.0, "cadence2": 78.0, "speed": 15.55, "gradient": 9.1, "distance": 205.0, "motor": "134", "main_ib": "13500", "torque": 27.35, "level": 3.0}, {"_lat": 24.199659, "_lon": 120.585706, "dist_km": 0.209, "_elev": 222.2, "time": "2025-08-27 10:12:42", "elevation": 222.2, "power": 271.0, "cadence1": 82.0, "cadence2": 77.0, "speed": 15.38, "gradient": 9.82, "distance": 209.0, "motor": "134", "main_ib": "13500", "torque": 27.5, "level": 3.0}, {"_lat": 24.199641, "_lon": 120.58574, "dist_km": 0.213, "_elev": 222.6, "time": "2025-08-27 10:12:43", "elevation": 222.6, "power": 276.0, "cadence1": 79.0, "cadence2": 87.0, "speed": 14.95, "gradient": 10.03, "distance": 213.0, "motor": "135", "main_ib": "13500", "torque": 18.35, "level": 3.0}, {"_lat": 24.199624, "_lon": 120.585774, "dist_km": 0.217, "_elev": 223.0, "time": "2025-08-27 10:12:44", "elevation": 223.0, "power": 294.0, "cadence1": 76.0, "cadence2": 88.0, "speed": 14.75, "gradient": 10.17, "distance": 217.0, "motor": "136", "main_ib": "13500", "torque": 21.9, "level": 3.0}, {"_lat": 24.199605, "_lon": 120.585806, "dist_km": 0.221, "_elev": 223.4, "time": "2025-08-27 10:12:45", "elevation": 223.4, "power": 331.0, "cadence1": 77.0, "cadence2": 90.0, "speed": 14.48, "gradient": 10.33, "distance": 221.0, "motor": "136", "main_ib": "13400", "torque": 21.05, "level": 3.0}, {"_lat": 24.199584, "_lon": 120.58584, "dist_km": 0.225, "_elev": 223.8, "time": "2025-08-27 10:12:46", "elevation": 223.8, "power": 279.0, "cadence1": 89.0, "cadence2": 88.0, "speed": 14.18, "gradient": 9.6, "distance": 225.0, "motor": "136", "main_ib": "13400", "torque": 16.849999999999998, "level": 3.0}, {"_lat": 24.199563, "_lon": 120.585871, "dist_km": 0.229, "_elev": 224.2, "time": "2025-08-27 10:12:47", "elevation": 224.2, "power": 312.0, "cadence1": 90.0, "cadence2": 92.0, "speed": 14.28, "gradient": 10.21, "distance": 229.0, "motor": "136", "main_ib": "13400", "torque": 20.55, "level": 3.0}, {"_lat": 24.19954, "_lon": 120.585902, "dist_km": 0.233, "_elev": 224.4, "time": "2025-08-27 10:12:48", "elevation": 224.4, "power": 311.0, "cadence1": 89.0, "cadence2": 92.0, "speed": 13.98, "gradient": 4.93, "distance": 233.0, "motor": "136", "main_ib": "13500", "torque": 17.2, "level": 3.0}, {"_lat": 24.19952, "_lon": 120.585937, "dist_km": 0.237, "_elev": 224.8, "time": "2025-08-27 10:12:49", "elevation": 224.8, "power": 288.0, "cadence1": 91.0, "cadence2": 92.0, "speed": 14.24, "gradient": 9.55, "distance": 237.0, "motor": "137", "main_ib": "10300", "torque": 17.2, "level": 3.0}, {"_lat": 24.199495, "_lon": 120.585968, "dist_km": 0.241, "_elev": 225.4, "time": "2025-08-27 10:12:50", "elevation": 225.4, "power": 335.0, "cadence1": 94.0, "cadence2": 88.0, "speed": 14.71, "gradient": 14.3, "distance": 241.0, "motor": "137", "main_ib": "13400", "torque": 17.1, "level": 3.0}, {"_lat": 24.199471, "_lon": 120.585999, "dist_km": 0.245, "_elev": 226.2, "time": "2025-08-27 10:12:51", "elevation": 226.2, "power": 329.0, "cadence1": 92.0, "cadence2": 89.0, "speed": 14.78, "gradient": 19.4, "distance": 245.0, "motor": "137", "main_ib": "13100", "torque": 17.8, "level": 3.0}, {"_lat": 24.19945, "_lon": 120.586032, "dist_km": 0.25, "_elev": 226.4, "time": "2025-08-27 10:12:52", "elevation": 226.4, "power": 293.0, "cadence1": 91.0, "cadence2": 90.0, "speed": 14.48, "gradient": 4.9, "distance": 250.0, "motor": "137", "main_ib": "13500", "torque": 20.55, "level": 3.0}, {"_lat": 24.199427, "_lon": 120.586061, "dist_km": 0.254, "_elev": 226.8, "time": "2025-08-27 10:12:53", "elevation": 226.8, "power": 315.0, "cadence1": 91.0, "cadence2": 90.0, "speed": 14.28, "gradient": 10.26, "distance": 254.0, "motor": "137", "main_ib": "13500", "torque": 21.55, "level": 3.0}, {"_lat": 24.199404, "_lon": 120.586087, "dist_km": 0.257, "_elev": 227.2, "time": "2025-08-27 10:12:54", "elevation": 227.2, "power": 319.0, "cadence1": 89.0, "cadence2": 89.0, "speed": 13.98, "gradient": 10.89, "distance": 257.0, "motor": "137", "main_ib": "13500", "torque": 26.049999999999997, "level": 3.0}, {"_lat": 24.199378, "_lon": 120.586114, "dist_km": 0.261, "_elev": 227.6, "time": "2025-08-27 10:12:55", "elevation": 227.6, "power": 340.0, "cadence1": 91.0, "cadence2": 90.0, "speed": 13.84, "gradient": 10.04, "distance": 261.0, "motor": "138", "main_ib": "13500", "torque": 21.4, "level": 3.0}, {"_lat": 24.199354, "_lon": 120.586142, "dist_km": 0.265, "_elev": 228.0, "time": "2025-08-27 10:12:56", "elevation": 228.0, "power": 346.0, "cadence1": 88.0, "cadence2": 91.0, "speed": 14.08, "gradient": 10.26, "distance": 265.0, "motor": "138", "main_ib": "13500", "torque": 20.65, "level": 3.0}, {"_lat": 24.19933, "_lon": 120.586172, "dist_km": 0.269, "_elev": 228.4, "time": "2025-08-27 10:12:57", "elevation": 228.4, "power": 354.0, "cadence1": 90.0, "cadence2": 88.0, "speed": 14.04, "gradient": 9.88, "distance": 269.0, "motor": "138", "main_ib": "13400", "torque": 16.6, "level": 3.0}, {"_lat": 24.199304, "_lon": 120.586204, "dist_km": 0.273, "_elev": 228.8, "time": "2025-08-27 10:12:58", "elevation": 228.8, "power": 336.0, "cadence1": 91.0, "cadence2": 89.0, "speed": 14.31, "gradient": 9.2, "distance": 273.0, "motor": "138", "main_ib": "12600", "torque": 15.8, "level": 3.0}, {"_lat": 24.199278, "_lon": 120.586232, "dist_km": 0.277, "_elev": 229.2, "time": "2025-08-27 10:12:59", "elevation": 229.2, "power": 310.0, "cadence1": 91.0, "cadence2": 87.0, "speed": 14.41, "gradient": 9.87, "distance": 277.0, "motor": "138", "main_ib": "13200", "torque": 18.25, "level": 3.0}, {"_lat": 24.19925, "_lon": 120.58626, "dist_km": 0.282, "_elev": 229.8, "time": "2025-08-27 10:13:00", "elevation": 229.8, "power": 299.0, "cadence1": 89.0, "cadence2": 86.0, "speed": 14.14, "gradient": 14.24, "distance": 282.0, "motor": "138", "main_ib": "13500", "torque": 29.6, "level": 3.0}, {"_lat": 24.199223, "_lon": 120.586288, "dist_km": 0.286, "_elev": 230.2, "time": "2025-08-27 10:13:01", "elevation": 230.2, "power": 305.0, "cadence1": 88.0, "cadence2": 90.0, "speed": 14.01, "gradient": 9.68, "distance": 286.0, "motor": "138", "main_ib": "13500", "torque": 22.9, "level": 3.0}, {"_lat": 24.199198, "_lon": 120.586317, "dist_km": 0.29, "_elev": 230.6, "time": "2025-08-27 10:13:02", "elevation": 230.6, "power": 316.0, "cadence1": 88.0, "cadence2": 90.0, "speed": 13.57, "gradient": 9.88, "distance": 290.0, "motor": "139", "main_ib": "13500", "torque": 18.0, "level": 3.0}, {"_lat": 24.199177, "_lon": 120.586343, "dist_km": 0.293, "_elev": 230.8, "time": "2025-08-27 10:13:03", "elevation": 230.8, "power": 335.0, "cadence1": 88.0, "cadence2": 93.0, "speed": 12.9, "gradient": 5.68, "distance": 293.0, "motor": "140", "main_ib": "13400", "torque": 11.549999999999999, "level": 3.0}, {"_lat": 24.199158, "_lon": 120.58637, "dist_km": 0.297, "_elev": 231.2, "time": "2025-08-27 10:13:04", "elevation": 231.2, "power": 307.0, "cadence1": 89.0, "cadence2": 95.0, "speed": 12.6, "gradient": 11.57, "distance": 297.0, "motor": "140", "main_ib": "13200", "torque": 15.4, "level": 3.0}, {"_lat": 24.199133, "_lon": 120.586398, "dist_km": 0.301, "_elev": 231.6, "time": "2025-08-27 10:13:05", "elevation": 231.6, "power": 329.0, "cadence1": 95.0, "cadence2": 93.0, "speed": 13.94, "gradient": 10.07, "distance": 301.0, "motor": "140", "main_ib": "12000", "torque": 18.3, "level": 3.0}, {"_lat": 24.199105, "_lon": 120.586429, "dist_km": 0.305, "_elev": 231.6, "time": "2025-08-27 10:13:06", "elevation": 231.6, "power": 323.0, "cadence1": 96.0, "cadence2": 93.0, "speed": 14.61, "gradient": 0.0, "distance": 305.0, "motor": "140", "main_ib": "12800", "torque": 11.7, "level": 3.0}, {"_lat": 24.199076, "_lon": 120.586461, "dist_km": 0.31, "_elev": 232.0, "time": "2025-08-27 10:13:07", "elevation": 232.0, "power": 317.0, "cadence1": 95.0, "cadence2": 92.0, "speed": 14.91, "gradient": 8.74, "distance": 310.0, "motor": "140", "main_ib": "9800", "torque": 13.65, "level": 3.0}, {"_lat": 24.199051, "_lon": 120.586489, "dist_km": 0.314, "_elev": 232.4, "time": "2025-08-27 10:13:08", "elevation": 232.4, "power": 300.0, "cadence1": 95.0, "cadence2": 91.0, "speed": 15.28, "gradient": 10.07, "distance": 314.0, "motor": "140", "main_ib": "11700", "torque": 20.9, "level": 3.0}, {"_lat": 24.199025, "_lon": 120.586515, "dist_km": 0.318, "_elev": 232.6, "time": "2025-08-27 10:13:09", "elevation": 232.6, "power": 301.0, "cadence1": 93.0, "cadence2": 92.0, "speed": 14.71, "gradient": 5.11, "distance": 318.0, "motor": "140", "main_ib": "11200", "torque": 17.4, "level": 3.0}, {"_lat": 24.199003, "_lon": 120.586542, "dist_km": 0.321, "_elev": 233.0, "time": "2025-08-27 10:13:10", "elevation": 233.0, "power": 287.0, "cadence1": 92.0, "cadence2": 88.0, "speed": 13.3, "gradient": 10.89, "distance": 321.0, "motor": "140", "main_ib": "9900", "torque": 18.6, "level": 3.0}, {"_lat": 24.198978, "_lon": 120.586568, "dist_km": 0.325, "_elev": 233.2, "time": "2025-08-27 10:13:11", "elevation": 233.2, "power": 266.0, "cadence1": 92.0, "cadence2": 87.0, "speed": 13.71, "gradient": 5.22, "distance": 325.0, "motor": "140", "main_ib": "9500", "torque": 16.9, "level": 3.0}, {"_lat": 24.198955, "_lon": 120.586593, "dist_km": 0.328, "_elev": 233.8, "time": "2025-08-27 10:13:12", "elevation": 233.8, "power": 283.0, "cadence1": 89.0, "cadence2": 88.0, "speed": 13.37, "gradient": 16.66, "distance": 328.0, "motor": "140", "main_ib": "8900", "torque": 25.75, "level": 3.0}, {"_lat": 24.19893, "_lon": 120.58662, "dist_km": 0.332, "_elev": 234.2, "time": "2025-08-27 10:13:13", "elevation": 234.2, "power": 303.0, "cadence1": 89.0, "cadence2": 88.0, "speed": 12.83, "gradient": 10.25, "distance": 332.0, "motor": "140", "main_ib": "9000", "torque": 21.299999999999997, "level": 3.0}, {"_lat": 24.198906, "_lon": 120.586652, "dist_km": 0.337, "_elev": 234.4, "time": "2025-08-27 10:13:14", "elevation": 234.4, "power": 313.0, "cadence1": 89.0, "cadence2": 89.0, "speed": 12.77, "gradient": 4.76, "distance": 337.0, "motor": "140", "main_ib": "9000", "torque": 12.7, "level": 3.0}, {"_lat": 24.198881, "_lon": 120.586681, "dist_km": 0.341, "_elev": 234.8, "time": "2025-08-27 10:13:15", "elevation": 234.8, "power": 310.0, "cadence1": 89.0, "cadence2": 90.0, "speed": 13.67, "gradient": 9.88, "distance": 341.0, "motor": "140", "main_ib": "9000", "torque": 11.05, "level": 3.0}, {"_lat": 24.198858, "_lon": 120.586709, "dist_km": 0.344, "_elev": 235.0, "time": "2025-08-27 10:13:16", "elevation": 235.0, "power": 285.0, "cadence1": 88.0, "cadence2": 91.0, "speed": 14.14, "gradient": 5.23, "distance": 344.0, "motor": "140", "main_ib": "9000", "torque": 5.9, "level": 3.0}, {"_lat": 24.198832, "_lon": 120.58674, "dist_km": 0.349, "_elev": 235.4, "time": "2025-08-27 10:13:17", "elevation": 235.4, "power": 287.0, "cadence1": 89.0, "cadence2": 94.0, "speed": 14.11, "gradient": 9.36, "distance": 349.0, "motor": "140", "main_ib": "9000", "torque": 8.4, "level": 3.0}, {"_lat": 24.198806, "_lon": 120.586769, "dist_km": 0.353, "_elev": 235.6, "time": "2025-08-27 10:13:18", "elevation": 235.6, "power": 262.0, "cadence1": 95.0, "cadence2": 91.0, "speed": 13.98, "gradient": 4.85, "distance": 353.0, "motor": "140", "main_ib": "8700", "torque": 13.5, "level": 3.0}, {"_lat": 24.198778, "_lon": 120.586801, "dist_km": 0.357, "_elev": 235.8, "time": "2025-08-27 10:13:19", "elevation": 235.8, "power": 269.0, "cadence1": 95.0, "cadence2": 88.0, "speed": 14.24, "gradient": 4.45, "distance": 357.0, "motor": "140", "main_ib": "8900", "torque": 10.5, "level": 3.0}, {"_lat": 24.19875, "_lon": 120.586831, "dist_km": 0.362, "_elev": 236.2, "time": "2025-08-27 10:13:20", "elevation": 236.2, "power": 263.0, "cadence1": 92.0, "cadence2": 91.0, "speed": 14.38, "gradient": 9.19, "distance": 362.0, "motor": "140", "main_ib": "9000", "torque": 9.100000000000001, "level": 3.0}, {"_lat": 24.198725, "_lon": 120.586857, "dist_km": 0.366, "_elev": 236.4, "time": "2025-08-27 10:13:21", "elevation": 236.4, "power": 256.0, "cadence1": 89.0, "cadence2": 89.0, "speed": 13.03, "gradient": 5.22, "distance": 366.0, "motor": "139", "main_ib": "9000", "torque": 18.0, "level": 3.0}, {"_lat": 24.198701, "_lon": 120.586888, "dist_km": 0.37, "_elev": 236.8, "time": "2025-08-27 10:13:22", "elevation": 236.8, "power": 264.0, "cadence1": 89.0, "cadence2": 89.0, "speed": 14.21, "gradient": 9.7, "distance": 370.0, "motor": "138", "main_ib": "8900", "torque": 17.2, "level": 3.0}, {"_lat": 24.19868, "_lon": 120.586916, "dist_km": 0.373, "_elev": 237.0, "time": "2025-08-27 10:13:23", "elevation": 237.0, "power": 286.0, "cadence1": 90.0, "cadence2": 89.0, "speed": 13.87, "gradient": 5.44, "distance": 373.0, "motor": "138", "main_ib": "9000", "torque": 24.049999999999997, "level": 3.0}, {"_lat": 24.198657, "_lon": 120.586943, "dist_km": 0.377, "_elev": 237.2, "time": "2025-08-27 10:13:24", "elevation": 237.2, "power": 334.0, "cadence1": 89.0, "cadence2": 88.0, "speed": 13.94, "gradient": 5.34, "distance": 377.0, "motor": "138", "main_ib": "8800", "torque": 17.8, "level": 3.0}, {"_lat": 24.198631, "_lon": 120.586973, "dist_km": 0.381, "_elev": 237.4, "time": "2025-08-27 10:13:25", "elevation": 237.4, "power": 351.0, "cadence1": 90.0, "cadence2": 89.0, "speed": 14.01, "gradient": 4.77, "distance": 381.0, "motor": "138", "main_ib": "9000", "torque": 28.15, "level": 3.0}, {"_lat": 24.198606, "_lon": 120.587004, "dist_km": 0.386, "_elev": 237.8, "time": "2025-08-27 10:13:26", "elevation": 237.8, "power": 343.0, "cadence1": 90.0, "cadence2": 86.0, "speed": 14.14, "gradient": 9.53, "distance": 386.0, "motor": "138", "main_ib": "9100", "torque": 27.95, "level": 3.0}, {"_lat": 24.198581, "_lon": 120.587033, "dist_km": 0.39, "_elev": 238.0, "time": "2025-08-27 10:13:27", "elevation": 238.0, "power": 330.0, "cadence1": 87.0, "cadence2": 85.0, "speed": 13.74, "gradient": 4.94, "distance": 390.0, "motor": "137", "main_ib": "9000", "torque": 33.2, "level": 3.0}, {"_lat": 24.198555, "_lon": 120.587063, "dist_km": 0.394, "_elev": 238.4, "time": "2025-08-27 10:13:28", "elevation": 238.4, "power": 330.0, "cadence1": 86.0, "cadence2": 82.0, "speed": 13.87, "gradient": 9.53, "distance": 394.0, "motor": "136", "main_ib": "9000", "torque": 27.5, "level": 3.0}, {"_lat": 24.198534, "_lon": 120.58709, "dist_km": 0.398, "_elev": 238.6, "time": "2025-08-27 10:13:29", "elevation": 238.6, "power": 368.0, "cadence1": 85.0, "cadence2": 81.0, "speed": 13.5, "gradient": 5.56, "distance": 398.0, "motor": "136", "main_ib": "9100", "torque": 26.4, "level": 3.0}, {"_lat": 24.198512, "_lon": 120.587116, "dist_km": 0.401, "_elev": 239.0, "time": "2025-08-27 10:13:30", "elevation": 239.0, "power": 366.0, "cadence1": 84.0, "cadence2": 84.0, "speed": 13.5, "gradient": 11.12, "distance": 401.0, "motor": "136", "main_ib": "9000", "torque": 27.8, "level": 3.0}, {"_lat": 24.198489, "_lon": 120.58714, "dist_km": 0.405, "_elev": 239.4, "time": "2025-08-27 10:13:31", "elevation": 239.4, "power": 377.0, "cadence1": 83.0, "cadence2": 81.0, "speed": 13.0, "gradient": 11.33, "distance": 405.0, "motor": "136", "main_ib": "8900", "torque": 39.0, "level": 3.0}, {"_lat": 24.198468, "_lon": 120.587163, "dist_km": 0.408, "_elev": 239.6, "time": "2025-08-27 10:13:32", "elevation": 239.6, "power": 370.0, "cadence1": 83.0, "cadence2": 82.0, "speed": 13.0, "gradient": 6.06, "distance": 408.0, "motor": "136", "main_ib": "9000", "torque": 30.35, "level": 3.0}, {"_lat": 24.198447, "_lon": 120.587185, "dist_km": 0.411, "_elev": 240.0, "time": "2025-08-27 10:13:33", "elevation": 240.0, "power": 336.0, "cadence1": 82.0, "cadence2": 79.0, "speed": 12.83, "gradient": 12.38, "distance": 411.0, "motor": "136", "main_ib": "8900", "torque": 25.65, "level": 3.0}, {"_lat": 24.198428, "_lon": 120.587207, "dist_km": 0.414, "_elev": 240.4, "time": "2025-08-27 10:13:34", "elevation": 240.4, "power": 403.0, "cadence1": 82.0, "cadence2": 81.0, "speed": 12.93, "gradient": 13.02, "distance": 414.0, "motor": "136", "main_ib": "8900", "torque": 32.15, "level": 3.0}, {"_lat": 24.198404, "_lon": 120.587236, "dist_km": 0.418, "_elev": 240.8, "time": "2025-08-27 10:13:35", "elevation": 240.8, "power": 378.0, "cadence1": 81.0, "cadence2": 85.0, "speed": 12.83, "gradient": 10.07, "distance": 418.0, "motor": "136", "main_ib": "8700", "torque": 37.7, "level": 3.0}, {"_lat": 24.198379, "_lon": 120.58726, "dist_km": 0.422, "_elev": 241.2, "time": "2025-08-27 10:13:36", "elevation": 241.2, "power": 397.0, "cadence1": 81.0, "cadence2": 80.0, "speed": 12.29, "gradient": 10.83, "distance": 422.0, "motor": "136", "main_ib": "9000", "torque": 30.15, "level": 3.0}, {"_lat": 24.198354, "_lon": 120.587283, "dist_km": 0.425, "_elev": 241.6, "time": "2025-08-27 10:13:37", "elevation": 241.6, "power": 376.0, "cadence1": 83.0, "cadence2": 79.0, "speed": 13.0, "gradient": 11.02, "distance": 425.0, "motor": "136", "main_ib": "8900", "torque": 24.049999999999997, "level": 3.0}, {"_lat": 24.198331, "_lon": 120.587308, "dist_km": 0.429, "_elev": 241.8, "time": "2025-08-27 10:13:38", "elevation": 241.8, "power": 376.0, "cadence1": 83.0, "cadence2": 79.0, "speed": 12.93, "gradient": 5.55, "distance": 429.0, "motor": "136", "main_ib": "9000", "torque": 43.75, "level": 3.0}, {"_lat": 24.198308, "_lon": 120.587335, "dist_km": 0.433, "_elev": 242.2, "time": "2025-08-27 10:13:39", "elevation": 242.2, "power": 376.0, "cadence1": 81.0, "cadence2": 79.0, "speed": 12.93, "gradient": 10.68, "distance": 433.0, "motor": "136", "main_ib": "8900", "torque": 33.45, "level": 3.0}, {"_lat": 24.198286, "_lon": 120.587359, "dist_km": 0.436, "_elev": 242.8, "time": "2025-08-27 10:13:40", "elevation": 242.8, "power": 375.0, "cadence1": 79.0, "cadence2": 77.0, "speed": 12.6, "gradient": 17.39, "distance": 436.0, "motor": "136", "main_ib": "8800", "torque": 20.799999999999997, "level": 3.0}, {"_lat": 24.198265, "_lon": 120.587387, "dist_km": 0.44, "_elev": 243.0, "time": "2025-08-27 10:13:41", "elevation": 243.0, "power": 356.0, "cadence1": 79.0, "cadence2": 78.0, "speed": 12.63, "gradient": 5.44, "distance": 440.0, "motor": "136", "main_ib": "9800", "torque": 40.0, "level": 3.0}, {"_lat": 24.198247, "_lon": 120.587423, "dist_km": 0.444, "_elev": 243.2, "time": "2025-08-27 10:13:42", "elevation": 243.2, "power": 344.0, "cadence1": 76.0, "cadence2": 80.0, "speed": 12.06, "gradient": 4.8, "distance": 444.0, "motor": "136", "main_ib": "10500", "torque": 24.150000000000002, "level": 3.0}, {"_lat": 24.198238, "_lon": 120.587459, "dist_km": 0.448, "_elev": 243.6, "time": "2025-08-27 10:13:43", "elevation": 243.6, "power": 327.0, "cadence1": 75.0, "cadence2": 80.0, "speed": 12.16, "gradient": 10.57, "distance": 448.0, "motor": "135", "main_ib": "11200", "torque": 25.05, "level": 3.0}, {"_lat": 24.198238, "_lon": 120.587496, "dist_km": 0.451, "_elev": 243.8, "time": "2025-08-27 10:13:44", "elevation": 243.8, "power": 335.0, "cadence1": 76.0, "cadence2": 80.0, "speed": 11.99, "gradient": 5.33, "distance": 451.0, "motor": "136", "main_ib": "12200", "torque": 27.85, "level": 3.0}, {"_lat": 24.198242, "_lon": 120.587535, "dist_km": 0.456, "_elev": 244.2, "time": "2025-08-27 10:13:45", "elevation": 244.2, "power": 386.0, "cadence1": 81.0, "cadence2": 81.0, "speed": 12.09, "gradient": 10.05, "distance": 456.0, "motor": "136", "main_ib": "13300", "torque": 18.55, "level": 3.0}, {"_lat": 24.198251, "_lon": 120.58757, "dist_km": 0.459, "_elev": 244.4, "time": "2025-08-27 10:13:46", "elevation": 244.4, "power": 330.0, "cadence1": 81.0, "cadence2": 82.0, "speed": 12.66, "gradient": 5.42, "distance": 459.0, "motor": "136", "main_ib": "13600", "torque": 21.9, "level": 3.0}, {"_lat": 24.19826, "_lon": 120.587601, "dist_km": 0.463, "_elev": 245.0, "time": "2025-08-27 10:13:47", "elevation": 245.0, "power": 313.0, "cadence1": 81.0, "cadence2": 83.0, "speed": 12.77, "gradient": 18.18, "distance": 463.0, "motor": "136", "main_ib": "13400", "torque": 22.25, "level": 3.0}, {"_lat": 24.198271, "_lon": 120.587631, "dist_km": 0.466, "_elev": 245.4, "time": "2025-08-27 10:13:48", "elevation": 245.4, "power": 322.0, "cadence1": 83.0, "cadence2": 85.0, "speed": 13.03, "gradient": 12.2, "distance": 466.0, "motor": "136", "main_ib": "13600", "torque": 21.65, "level": 3.0}, {"_lat": 24.198281, "_lon": 120.587665, "dist_km": 0.469, "_elev": 245.6, "time": "2025-08-27 10:13:49", "elevation": 245.6, "power": 329.0, "cadence1": 88.0, "cadence2": 86.0, "speed": 13.37, "gradient": 5.52, "distance": 469.0, "motor": "136", "main_ib": "13400", "torque": 25.299999999999997, "level": 3.0}, {"_lat": 24.198289, "_lon": 120.587699, "dist_km": 0.473, "_elev": 246.0, "time": "2025-08-27 10:13:50", "elevation": 246.0, "power": 319.0, "cadence1": 84.0, "cadence2": 85.0, "speed": 13.33, "gradient": 11.23, "distance": 473.0, "motor": "136", "main_ib": "13400", "torque": 27.4, "level": 3.0}, {"_lat": 24.1983, "_lon": 120.587734, "dist_km": 0.477, "_elev": 246.6, "time": "2025-08-27 10:13:51", "elevation": 246.6, "power": 300.0, "cadence1": 87.0, "cadence2": 85.0, "speed": 13.71, "gradient": 15.98, "distance": 477.0, "motor": "138", "main_ib": "13500", "torque": 17.45, "level": 3.0}, {"_lat": 24.198311, "_lon": 120.587766, "dist_km": 0.48, "_elev": 247.0, "time": "2025-08-27 10:13:52", "elevation": 247.0, "power": 307.0, "cadence1": 87.0, "cadence2": 86.0, "speed": 13.5, "gradient": 11.53, "distance": 480.0, "motor": "138", "main_ib": "13500", "torque": 13.100000000000001, "level": 3.0}, {"_lat": 24.198323, "_lon": 120.587798, "dist_km": 0.484, "_elev": 247.2, "time": "2025-08-27 10:13:53", "elevation": 247.2, "power": 310.0, "cadence1": 86.0, "cadence2": 89.0, "speed": 13.6, "gradient": 5.7, "distance": 484.0, "motor": "138", "main_ib": "13400", "torque": 23.4, "level": 3.0}, {"_lat": 24.198334, "_lon": 120.587832, "dist_km": 0.487, "_elev": 247.4, "time": "2025-08-27 10:13:54", "elevation": 247.4, "power": 310.0, "cadence1": 88.0, "cadence2": 87.0, "speed": 13.81, "gradient": 5.47, "distance": 487.0, "motor": "138", "main_ib": "13400", "torque": 21.950000000000003, "level": 3.0}, {"_lat": 24.198341, "_lon": 120.587871, "dist_km": 0.491, "_elev": 247.8, "time": "2025-08-27 10:13:55", "elevation": 247.8, "power": 323.0, "cadence1": 88.0, "cadence2": 88.0, "speed": 13.6, "gradient": 9.92, "distance": 491.0, "motor": "138", "main_ib": "13400", "torque": 26.200000000000003, "level": 3.0}, {"_lat": 24.198352, "_lon": 120.587906, "dist_km": 0.495, "_elev": 248.2, "time": "2025-08-27 10:13:56", "elevation": 248.2, "power": 296.0, "cadence1": 86.0, "cadence2": 85.0, "speed": 13.77, "gradient": 10.65, "distance": 495.0, "motor": "139", "main_ib": "13500", "torque": 20.8, "level": 3.0}, {"_lat": 24.198366, "_lon": 120.587945, "dist_km": 0.499, "_elev": 248.4, "time": "2025-08-27 10:13:57", "elevation": 248.4, "power": 325.0, "cadence1": 85.0, "cadence2": 85.0, "speed": 13.94, "gradient": 4.7, "distance": 499.0, "motor": "138", "main_ib": "13500", "torque": 25.1, "level": 3.0}, {"_lat": 24.198379, "_lon": 120.587982, "dist_km": 0.503, "_elev": 248.8, "time": "2025-08-27 10:13:58", "elevation": 248.8, "power": 362.0, "cadence1": 89.0, "cadence2": 86.0, "speed": 13.77, "gradient": 9.95, "distance": 503.0, "motor": "139", "main_ib": "13400", "torque": 19.05, "level": 3.0}, {"_lat": 24.198389, "_lon": 120.588019, "dist_km": 0.507, "_elev": 249.2, "time": "2025-08-27 10:13:59", "elevation": 249.2, "power": 328.0, "cadence1": 90.0, "cadence2": 86.0, "speed": 13.67, "gradient": 10.22, "distance": 507.0, "motor": "140", "main_ib": "13500", "torque": 14.149999999999999, "level": 3.0}, {"_lat": 24.1984, "_lon": 120.588052, "dist_km": 0.511, "_elev": 249.4, "time": "2025-08-27 10:14:00", "elevation": 249.4, "power": 337.0, "cadence1": 86.0, "cadence2": 96.0, "speed": 13.54, "gradient": 5.61, "distance": 511.0, "motor": "141", "main_ib": "12500", "torque": 4.55, "level": 3.0}, {"_lat": 24.198415, "_lon": 120.588084, "dist_km": 0.514, "_elev": 250.0, "time": "2025-08-27 10:14:01", "elevation": 250.0, "power": 308.0, "cadence1": 91.0, "cadence2": 100.0, "speed": 13.47, "gradient": 16.44, "distance": 514.0, "motor": "142", "main_ib": "10100", "torque": 10.1, "level": 3.0}, {"_lat": 24.198429, "_lon": 120.58812, "dist_km": 0.518, "_elev": 250.4, "time": "2025-08-27 10:14:02", "elevation": 250.4, "power": 256.0, "cadence1": 93.0, "cadence2": 104.0, "speed": 14.28, "gradient": 10.08, "distance": 518.0, "motor": "142", "main_ib": "9300", "torque": 2.1999999999999997, "level": 3.0}, {"_lat": 24.198443, "_lon": 120.588162, "dist_km": 0.523, "_elev": 250.6, "time": "2025-08-27 10:14:03", "elevation": 250.6, "power": 301.0, "cadence1": 102.0, "cadence2": 109.0, "speed": 15.69, "gradient": 4.41, "distance": 523.0, "motor": "142", "main_ib": "7300", "torque": 17.9, "level": 3.0}, {"_lat": 24.198459, "_lon": 120.588204, "dist_km": 0.527, "_elev": 250.8, "time": "2025-08-27 10:14:04", "elevation": 250.8, "power": 264.0, "cadence1": 104.0, "cadence2": 103.0, "speed": 16.43, "gradient": 4.33, "distance": 527.0, "motor": "142", "main_ib": "9200", "torque": 4.05, "level": 3.0}, {"_lat": 24.198473, "_lon": 120.588253, "dist_km": 0.533, "_elev": 251.0, "time": "2025-08-27 10:14:05", "elevation": 251.0, "power": 306.0, "cadence1": 108.0, "cadence2": 89.0, "speed": 16.96, "gradient": 3.84, "distance": 533.0, "motor": "142", "main_ib": "7100", "torque": 8.25, "level": 3.0}, {"_lat": 24.198488, "_lon": 120.588298, "dist_km": 0.538, "_elev": 251.2, "time": "2025-08-27 10:14:06", "elevation": 251.2, "power": 352.0, "cadence1": 106.0, "cadence2": 78.0, "speed": 16.66, "gradient": 4.12, "distance": 538.0, "motor": "142", "main_ib": "8900", "torque": 19.35, "level": 3.0}, {"_lat": 24.198502, "_lon": 120.588336, "dist_km": 0.542, "_elev": 251.4, "time": "2025-08-27 10:14:07", "elevation": 251.4, "power": 244.0, "cadence1": 90.0, "cadence2": 73.0, "speed": 14.91, "gradient": 4.81, "distance": 542.0, "motor": "142", "main_ib": "9000", "torque": 7.2, "level": 3.0}, {"_lat": 24.198512, "_lon": 120.588371, "dist_km": 0.546, "_elev": 251.8, "time": "2025-08-27 10:14:08", "elevation": 251.8, "power": 209.0, "cadence1": 90.0, "cadence2": 64.0, "speed": 12.77, "gradient": 10.75, "distance": 546.0, "motor": "142", "main_ib": "7700", "torque": 1.9500000000000002, "level": 3.0}, {"_lat": 24.198521, "_lon": 120.588404, "dist_km": 0.549, "_elev": 252.0, "time": "2025-08-27 10:14:09", "elevation": 252.0, "power": 209.0, "cadence1": 72.0, "cadence2": 51.0, "speed": 11.76, "gradient": 5.73, "distance": 549.0, "motor": "140", "main_ib": "3700", "torque": 0.0, "level": 3.0}, {"_lat": 24.198531, "_lon": 120.588427, "dist_km": 0.552, "_elev": 252.4, "time": "2025-08-27 10:14:10", "elevation": 252.4, "power": 164.0, "cadence1": 68.0, "cadence2": 0.0, "speed": 10.41, "gradient": 15.48, "distance": 552.0, "motor": "136", "main_ib": "0", "torque": 0.0, "level": 3.0}, {"_lat": 24.198539, "_lon": 120.58845, "dist_km": 0.554, "_elev": 253.0, "time": "2025-08-27 10:14:11", "elevation": 253.0, "power": 103.0, "cadence1": 57.0, "cadence2": 0.0, "speed": 9.04, "gradient": 24.03, "distance": 554.0, "motor": "134", "main_ib": "0", "torque": 18.5, "level": 3.0}, {"_lat": 24.198544, "_lon": 120.588469, "dist_km": 0.556, "_elev": 253.4, "time": "2025-08-27 10:14:12", "elevation": 253.4, "power": 0.0, "cadence1": 57.0, "cadence2": 0.0, "speed": 6.72, "gradient": 19.94, "distance": 556.0, "motor": "134", "main_ib": "0", "torque": 25.1, "level": 3.0}, {"_lat": 24.198545, "_lon": 120.588479, "dist_km": 0.557, "_elev": 253.8, "time": "2025-08-27 10:14:13", "elevation": 253.8, "power": 0.0, "cadence1": 57.0, "cadence2": 0.0, "speed": 2.22, "gradient": 39.2, "distance": 557.0, "motor": "134", "main_ib": "0", "torque": 26.15, "level": 3.0}, {"_lat": 24.198545, "_lon": 120.588479, "dist_km": 0.557, "_elev": 254.0, "time": "2025-08-27 10:14:14", "elevation": 254.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 0.0, "gradient": null, "distance": 557.0, "motor": "134", "main_ib": "0", "torque": 26.200000000000003, "level": 3.0}, {"_lat": 24.198545, "_lon": 120.588479, "dist_km": 0.557, "_elev": 254.0, "time": "2025-08-27 10:14:15", "elevation": 254.0, "power": 0.0, "cadence1": 0.0, "cadence2": 0.0, "speed": 0.0, "gradient": null, "distance": 557.0, "motor": "133", "main_ib": "0", "torque": 27.0, "level": 3.0}];

function fmt(v, n=2) { if(v===null||v===undefined||Number.isNaN(v)) return '—'; return (+v).toFixed(n); }
function fmtInt(v) { if(v===null||v===undefined||Number.isNaN(v)) return '—'; return Math.round(+v).toString(); }

const map = L.map('map', { zoomControl: true });
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19, attribution: '&copy; OpenStreetMap'
}).addTo(map);

const latlngs = POINTS.map(p => [p._lat, p._lon]).filter(x => x[0]!=null && x[1]!=null);
const line = L.polyline(latlngs, {color:'#0066cc', weight:3}).addTo(map);
if(latlngs.length) map.fitBounds(line.getBounds());
const cursor = latlngs.length ? L.circleMarker(latlngs[0], {radius:6, color:'#d62728', weight:2, fillColor:'#fff', fillOpacity:1}).addTo(map) : null;

// 建立透明 markers 讓地圖 hover 同步
const markers = L.layerGroup().addTo(map);
for(let i=0;i<POINTS.length;i++) {
  const p = POINTS[i];
  if(p._lat==null||p._lon==null) continue;
  const m = L.circleMarker([p._lat, p._lon], {radius:6, weight:0, fillOpacity:0});
  m.on('mouseover', ()=> updateByIndex(i));
  markers.addLayer(m);
}

const canvas = document.getElementById('elevCanvas');
const ctx = canvas.getContext('2d');
const DISTS = POINTS.map(p => p.dist_km ?? 0);
const ELEVS = POINTS.map(p => p._elev ?? 0);

function resizeCanvas(){
  const rect = canvas.parentElement.getBoundingClientRect();
  canvas.width = Math.max(1, rect.width * devicePixelRatio);
  canvas.height = Math.max(1, rect.height * devicePixelRatio);
  drawProfile();
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function drawProfile(highlightIndex = 0){
  const w = canvas.width, h = canvas.height;
  ctx.clearRect(0,0,w,h);
  if(DISTS.length===0) return;
  const minX = DISTS[0], maxX = DISTS[DISTS.length-1];
  const minY = Math.min(...ELEVS), maxY = Math.max(...ELEVS);
  function xScale(x){ return (x - minX) / (maxX - minX || 1) * (w*0.98) + (w*0.01); }
  function yScale(y){ return h*0.95 - (y - minY) / (maxY - minY || 1) * (h*0.85); }

  // x 軸
  ctx.lineWidth = 1*devicePixelRatio; ctx.strokeStyle = '#ddd';
  ctx.beginPath(); ctx.moveTo(xScale(minX), yScale(minY)); ctx.lineTo(xScale(maxX), yScale(minY)); ctx.stroke();

  // 線
  ctx.lineWidth = 2.5*devicePixelRatio; ctx.strokeStyle = '#0066cc';
  ctx.beginPath();
  for(let i=0;i<DISTS.length;i++){ const x=xScale(DISTS[i]), y=yScale(ELEVS[i]); i===0?ctx.moveTo(x,y):ctx.lineTo(x,y); }
  ctx.stroke();

  // 高亮
  const ix = Math.max(0, Math.min(highlightIndex, DISTS.length-1));
  const cx = xScale(DISTS[ix]), cy = yScale(ELEVS[ix]);
  ctx.strokeStyle = 'rgba(0,0,0,.25)'; ctx.lineWidth = 1*devicePixelRatio;
  ctx.beginPath(); ctx.moveTo(cx, yScale(minY)); ctx.lineTo(cx, yScale(maxY)); ctx.stroke();
  ctx.fillStyle = '#d62728'; ctx.beginPath(); ctx.arc(cx, cy, 4*devicePixelRatio, 0, Math.PI*2); ctx.fill();
}

function binarySearchNearest(arr, value){
  let lo=0, hi=arr.length-1;
  while(lo<hi){ const mid=(lo+hi)>>1; if(arr[mid] < value) lo=mid+1; else hi=mid; }
  if(lo>0 && Math.abs(arr[lo]-value) > Math.abs(arr[lo-1]-value)) return lo-1;
  return lo;
}

function updateByIndex(i){
  if(i<0 || i>=POINTS.length) return;
  const p = POINTS[i];
  if(cursor && p._lat!=null && p._lon!=null) cursor.setLatLng([p._lat, p._lon]);
  document.getElementById('v_time').textContent = p.time || '—';
  document.getElementById('v_elev').textContent = fmt(p.elevation,1);
  document.getElementById('v_power').textContent = fmt(p.power,0);
  document.getElementById('v_cad1').textContent = fmt(p.cadence1,0);
  document.getElementById('v_speed').textContent = fmt(p.speed,2);
  document.getElementById('v_grad').textContent = fmt(p.gradient,2);
  document.getElementById('v_dist').textContent = `${fmtInt(p.distance)} m (${fmt(p.dist_km,3)} km)`;
  document.getElementById('v_motor').textContent = (p.motor ?? '—');
  document.getElementById('v_mainib').textContent = (p.main_ib ?? '—');
  document.getElementById('v_torque').textContent = fmt(p.torque,1);
  document.getElementById('v_cad2').textContent = fmt(p.cadence2,0);
  document.getElementById('v_level').textContent = fmt(p.level,0);
  drawProfile(i);
}

canvas.addEventListener('mousemove', (ev)=>{
  const rect = canvas.getBoundingClientRect();
  const px = (ev.clientX - rect.left) * devicePixelRatio;
  const w = canvas.width;
  const minX = DISTS[0], maxX = DISTS[DISTS.length-1];
  const xVal = (px - w*0.01) / (w*0.98) * (maxX - minX) + minX;
  const i = binarySearchNearest(DISTS, xVal);
  updateByIndex(i);
});

// 初始
updateByIndex(0);
</script>
</body>
</html>
