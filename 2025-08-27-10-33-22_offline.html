<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>2025-08-27-10-33-22.xlsx</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css"/>
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js"></script>
  <style>
    html, body { height:100%; margin:0; background:#fff; }
    #map { position:absolute; top:0; left:0; right:0; bottom:28vh; }
    #profile-wrap{ position:fixed; left:0; right:0; bottom:0; height:28vh; background:#fff;
                    box-shadow:0 -2px 10px rgba(0,0,0,.15); z-index:9999; }
    #profile-head{ display:flex; justify-content:space-between; align-items:center; padding:6px 12px;
                    font:14px/1.4 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC',Arial,'Helvetica Neue',sans-serif;
                    border-bottom:1px solid #eee }
    #profile-chart{ height:calc(28vh - 40px); padding:8px 12px }
    #profile-chart canvas{ width:100%; height:100% }
    #side-info{
      position:fixed; right:12px; top:12px; width:300px;
      background:rgba(255,255,255,.97); padding:10px 12px;
      border:1px solid #ddd; border-radius:10px;
      box-shadow:0 2px 10px rgba(0,0,0,.12); z-index:10050; pointer-events:none;
      font:13px/1.45 -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC',Arial,'Helvetica Neue',sans-serif;
      max-height:60vh; overflow:auto;
    }
    .kv{ display:flex; gap:6px } .k{ min-width:88px; color:#666 } .v{ flex:1 }
  </style>
</head>
<body>
  <div id="map"></div>

  <div id="side-info">
    <div style="font-weight:600; margin-bottom:6px;">資料資訊</div>
    <div class="kv"><div class="k">Time</div><div class="v" id="v_time">2025-08-27 10:33:22</div></div>
    <div class="kv"><div class="k">Elevation (m)</div><div class="v" id="v_elev">207.2</div></div>
    <div class="kv"><div class="k">Power (W)</div><div class="v" id="v_power">0.0</div></div>
    <div class="kv"><div class="k">Cadence1 (rpm)</div><div class="v" id="v_cad1">None</div></div>
    <div class="kv"><div class="k">Speed (km/h)</div><div class="v" id="v_speed">16.36</div></div>
    <div class="kv"><div class="k">Gradient (%)</div><div class="v" id="v_grad">None</div></div>
    <div class="kv"><div class="k">Distance</div><div class="v" id="v_dist">0 m (0.0 km)</div></div>
    <div class="kv"><div class="k">Motor</div><div class="v" id="v_motor">67</div></div>
    <div class="kv"><div class="k">Main ib</div><div class="v" id="v_mainib">7200</div></div>
    <div class="kv"><div class="k">Torque (Nm)</div><div class="v" id="v_torque">0.0</div></div>
    <div class="kv"><div class="k">Cadence2 (rpm)</div><div class="v" id="v_cad2">0.0</div></div>
    <div class="kv"><div class="k">Level</div><div class="v" id="v_level">3.0</div></div>
  </div>

  <div id="profile-wrap">
    <div id="profile-head">
      <div id="profile-title">剖面圖</div>
      <div id="profile-legend" style="opacity:.8">Elevation vs Distance</div>
    </div>
    <div id="profile-chart"><canvas id="elevCanvas"></canvas></div>
  </div>

<script>
const POINTS = [{"_lat": 24.200393, "_lon": 120.583947, "dist_km": 0.0, "_elev": 207.2, "time": "2025-08-27 10:33:22", "elevation": 207.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 16.36, "gradient": null, "distance": 0.0, "motor": "67", "main_ib": "7200", "torque": 0.0, "level": 3.0}, {"_lat": 24.20044, "_lon": 120.583951, "dist_km": 0.005, "_elev": 206.8, "time": "2025-08-27 10:33:23", "elevation": 206.8, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 17.5, "gradient": -7.63, "distance": 5.0, "motor": "69", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200483, "_lon": 120.583977, "dist_km": 0.01, "_elev": 206.4, "time": "2025-08-27 10:33:24", "elevation": 206.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 17.33, "gradient": -7.33, "distance": 10.0, "motor": "66", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200514, "_lon": 120.58402, "dist_km": 0.016, "_elev": 206.2, "time": "2025-08-27 10:33:25", "elevation": 206.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 18.51, "gradient": -3.6, "distance": 16.0, "motor": "69", "main_ib": "18800", "torque": 0.0, "level": 3.0}, {"_lat": 24.20052, "_lon": 120.584077, "dist_km": 0.021, "_elev": 206.0, "time": "2025-08-27 10:33:26", "elevation": 206.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 19.31, "gradient": -3.44, "distance": 21.0, "motor": "70", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200505, "_lon": 120.584128, "dist_km": 0.027, "_elev": 206.0, "time": "2025-08-27 10:33:27", "elevation": 206.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 17.2, "gradient": 0.0, "distance": 27.0, "motor": "70", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200488, "_lon": 120.584163, "dist_km": 0.031, "_elev": 206.0, "time": "2025-08-27 10:33:28", "elevation": 206.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 15.08, "gradient": 0.0, "distance": 31.0, "motor": "71", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200468, "_lon": 120.584192, "dist_km": 0.035, "_elev": 206.2, "time": "2025-08-27 10:33:29", "elevation": 206.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 13.91, "gradient": 5.42, "distance": 35.0, "motor": "72", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200453, "_lon": 120.584222, "dist_km": 0.038, "_elev": 206.4, "time": "2025-08-27 10:33:30", "elevation": 206.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 12.46, "gradient": 5.76, "distance": 38.0, "motor": "72", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200442, "_lon": 120.584254, "dist_km": 0.041, "_elev": 206.6, "time": "2025-08-27 10:33:31", "elevation": 206.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 11.42, "gradient": 5.77, "distance": 41.0, "motor": "74", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200431, "_lon": 120.584284, "dist_km": 0.045, "_elev": 207.0, "time": "2025-08-27 10:33:32", "elevation": 207.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.48, "gradient": 12.2, "distance": 45.0, "motor": "74", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200425, "_lon": 120.584311, "dist_km": 0.048, "_elev": 207.4, "time": "2025-08-27 10:33:33", "elevation": 207.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.21, "gradient": 14.19, "distance": 48.0, "motor": "76", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200419, "_lon": 120.58434, "dist_km": 0.051, "_elev": 208.0, "time": "2025-08-27 10:33:34", "elevation": 208.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.11, "gradient": 19.89, "distance": 51.0, "motor": "77", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200413, "_lon": 120.584363, "dist_km": 0.053, "_elev": 208.6, "time": "2025-08-27 10:33:35", "elevation": 208.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.28, "gradient": 24.73, "distance": 53.0, "motor": "78", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200408, "_lon": 120.584387, "dist_km": 0.055, "_elev": 209.2, "time": "2025-08-27 10:33:36", "elevation": 209.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.81, "gradient": 24.03, "distance": 55.0, "motor": "79", "main_ib": "19100", "torque": 0.0, "level": 3.0}, {"_lat": 24.200402, "_lon": 120.584418, "dist_km": 0.059, "_elev": 209.6, "time": "2025-08-27 10:33:37", "elevation": 209.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 11.15, "gradient": 12.45, "distance": 59.0, "motor": "80", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200396, "_lon": 120.584445, "dist_km": 0.062, "_elev": 209.6, "time": "2025-08-27 10:33:38", "elevation": 209.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.81, "gradient": 0.0, "distance": 62.0, "motor": "82", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200387, "_lon": 120.584471, "dist_km": 0.064, "_elev": 210.0, "time": "2025-08-27 10:33:39", "elevation": 210.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.48, "gradient": 14.18, "distance": 64.0, "motor": "83", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200379, "_lon": 120.5845, "dist_km": 0.067, "_elev": 210.2, "time": "2025-08-27 10:33:40", "elevation": 210.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.35, "gradient": 6.51, "distance": 67.0, "motor": "84", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.20037, "_lon": 120.584531, "dist_km": 0.071, "_elev": 210.6, "time": "2025-08-27 10:33:41", "elevation": 210.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 10.28, "gradient": 12.12, "distance": 71.0, "motor": "86", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200363, "_lon": 120.584558, "dist_km": 0.074, "_elev": 211.0, "time": "2025-08-27 10:33:42", "elevation": 211.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.87, "gradient": 14.05, "distance": 74.0, "motor": "88", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200357, "_lon": 120.584578, "dist_km": 0.076, "_elev": 211.4, "time": "2025-08-27 10:33:43", "elevation": 211.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.71, "gradient": 18.73, "distance": 76.0, "motor": "89", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200345, "_lon": 120.584594, "dist_km": 0.078, "_elev": 211.6, "time": "2025-08-27 10:33:44", "elevation": 211.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.47, "gradient": 9.52, "distance": 78.0, "motor": "90", "main_ib": "18900", "torque": 0.0, "level": 3.0}, {"_lat": 24.200332, "_lon": 120.584614, "dist_km": 0.08, "_elev": 211.8, "time": "2025-08-27 10:33:45", "elevation": 211.8, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.24, "gradient": 8.03, "distance": 80.0, "motor": "92", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200318, "_lon": 120.584635, "dist_km": 0.083, "_elev": 212.2, "time": "2025-08-27 10:33:46", "elevation": 212.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 8.77, "gradient": 15.16, "distance": 83.0, "motor": "93", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200305, "_lon": 120.584656, "dist_km": 0.085, "_elev": 212.4, "time": "2025-08-27 10:33:47", "elevation": 212.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 8.5, "gradient": 7.77, "distance": 85.0, "motor": "95", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200294, "_lon": 120.584679, "dist_km": 0.088, "_elev": 212.6, "time": "2025-08-27 10:33:48", "elevation": 212.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 8.67, "gradient": 7.59, "distance": 88.0, "motor": "97", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200281, "_lon": 120.5847, "dist_km": 0.091, "_elev": 212.8, "time": "2025-08-27 10:33:49", "elevation": 212.8, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 8.77, "gradient": 7.77, "distance": 91.0, "motor": "98", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200268, "_lon": 120.584719, "dist_km": 0.093, "_elev": 213.0, "time": "2025-08-27 10:33:50", "elevation": 213.0, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.21, "gradient": 8.3, "distance": 93.0, "motor": "100", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200258, "_lon": 120.58474, "dist_km": 0.095, "_elev": 213.2, "time": "2025-08-27 10:33:51", "elevation": 213.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.34, "gradient": 8.32, "distance": 95.0, "motor": "102", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200245, "_lon": 120.584761, "dist_km": 0.098, "_elev": 213.4, "time": "2025-08-27 10:33:52", "elevation": 213.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.31, "gradient": 7.77, "distance": 98.0, "motor": "103", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200229, "_lon": 120.584785, "dist_km": 0.101, "_elev": 213.8, "time": "2025-08-27 10:33:53", "elevation": 213.8, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.54, "gradient": 13.27, "distance": 101.0, "motor": "105", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200215, "_lon": 120.584804, "dist_km": 0.104, "_elev": 214.2, "time": "2025-08-27 10:33:54", "elevation": 214.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.27, "gradient": 16.15, "distance": 104.0, "motor": "107", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200201, "_lon": 120.584824, "dist_km": 0.106, "_elev": 214.2, "time": "2025-08-27 10:33:55", "elevation": 214.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.27, "gradient": 0.0, "distance": 106.0, "motor": "108", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.20019, "_lon": 120.584843, "dist_km": 0.108, "_elev": 214.6, "time": "2025-08-27 10:33:56", "elevation": 214.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.21, "gradient": 17.53, "distance": 108.0, "motor": "110", "main_ib": "19000", "torque": 0.0, "level": 3.0}, {"_lat": 24.200177, "_lon": 120.584867, "dist_km": 0.111, "_elev": 214.8, "time": "2025-08-27 10:33:57", "elevation": 214.8, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.61, "gradient": 7.06, "distance": 111.0, "motor": "112", "main_ib": "18400", "torque": 0.0, "level": 3.0}, {"_lat": 24.200165, "_lon": 120.58489, "dist_km": 0.114, "_elev": 215.2, "time": "2025-08-27 10:33:58", "elevation": 215.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.71, "gradient": 14.88, "distance": 114.0, "motor": "114", "main_ib": "16500", "torque": 0.0, "level": 3.0}, {"_lat": 24.20015, "_lon": 120.584913, "dist_km": 0.117, "_elev": 215.2, "time": "2025-08-27 10:33:59", "elevation": 215.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 9.91, "gradient": 0.0, "distance": 117.0, "motor": "115", "main_ib": "14500", "torque": 0.0, "level": 3.0}, {"_lat": 24.200138, "_lon": 120.584936, "dist_km": 0.119, "_elev": 215.6, "time": "2025-08-27 10:34:00", "elevation": 215.6, "power": 0.0, "cadence1": null, "cadence2": 38.5, "speed": 9.71, "gradient": 14.88, "distance": 119.0, "motor": "116", "main_ib": "12500", "torque": 22.75, "level": 3.0}, {"_lat": 24.200126, "_lon": 120.584959, "dist_km": 0.122, "_elev": 215.8, "time": "2025-08-27 10:34:01", "elevation": 215.8, "power": 0.0, "cadence1": null, "cadence2": 52.0, "speed": 9.54, "gradient": 7.44, "distance": 122.0, "motor": "116", "main_ib": "18000", "torque": 24.1, "level": 3.0}, {"_lat": 24.200113, "_lon": 120.584976, "dist_km": 0.125, "_elev": 216.0, "time": "2025-08-27 10:34:02", "elevation": 216.0, "power": 0.0, "cadence1": null, "cadence2": 63.5, "speed": 8.67, "gradient": 8.89, "distance": 125.0, "motor": "117", "main_ib": "18000", "torque": 17.700000000000003, "level": 3.0}, {"_lat": 24.200098, "_lon": 120.584989, "dist_km": 0.127, "_elev": 216.2, "time": "2025-08-27 10:34:03", "elevation": 216.2, "power": 0.0, "cadence1": null, "cadence2": 69.0, "speed": 8.6, "gradient": 9.41, "distance": 127.0, "motor": "118", "main_ib": "18000", "torque": 36.85, "level": 3.0}, {"_lat": 24.200081, "_lon": 120.585009, "dist_km": 0.129, "_elev": 216.4, "time": "2025-08-27 10:34:04", "elevation": 216.4, "power": 234.0, "cadence1": null, "cadence2": 76.5, "speed": 9.98, "gradient": 7.21, "distance": 129.0, "motor": "120", "main_ib": "17800", "torque": 18.25, "level": 3.0}, {"_lat": 24.200064, "_lon": 120.585033, "dist_km": 0.132, "_elev": 216.6, "time": "2025-08-27 10:34:05", "elevation": 216.6, "power": 282.0, "cadence1": null, "cadence2": 81.0, "speed": 11.22, "gradient": 6.49, "distance": 132.0, "motor": "121", "main_ib": "16000", "torque": 16.95, "level": 3.0}, {"_lat": 24.200045, "_lon": 120.585058, "dist_km": 0.136, "_elev": 216.8, "time": "2025-08-27 10:34:06", "elevation": 216.8, "power": 290.0, "cadence1": null, "cadence2": 84.5, "speed": 12.43, "gradient": 6.06, "distance": 136.0, "motor": "122", "main_ib": "16800", "torque": 26.85, "level": 3.0}, {"_lat": 24.200025, "_lon": 120.585089, "dist_km": 0.139, "_elev": 217.0, "time": "2025-08-27 10:34:07", "elevation": 217.0, "power": 286.0, "cadence1": null, "cadence2": 87.0, "speed": 13.07, "gradient": 5.19, "distance": 139.0, "motor": "123", "main_ib": "18100", "torque": 17.6, "level": 3.0}, {"_lat": 24.200003, "_lon": 120.585118, "dist_km": 0.143, "_elev": 217.2, "time": "2025-08-27 10:34:08", "elevation": 217.2, "power": 278.0, "cadence1": null, "cadence2": 91.0, "speed": 13.3, "gradient": 5.23, "distance": 143.0, "motor": "124", "main_ib": "18000", "torque": 24.55, "level": 3.0}, {"_lat": 24.199978, "_lon": 120.585147, "dist_km": 0.147, "_elev": 217.4, "time": "2025-08-27 10:34:09", "elevation": 217.4, "power": 356.0, "cadence1": null, "cadence2": 89.5, "speed": 14.21, "gradient": 4.94, "distance": 147.0, "motor": "125", "main_ib": "16500", "torque": 9.65, "level": 3.0}, {"_lat": 24.199953, "_lon": 120.585174, "dist_km": 0.151, "_elev": 217.6, "time": "2025-08-27 10:34:10", "elevation": 217.6, "power": 387.0, "cadence1": null, "cadence2": 94.0, "speed": 14.64, "gradient": 5.13, "distance": 151.0, "motor": "126", "main_ib": "18000", "torque": 22.05, "level": 3.0}, {"_lat": 24.199928, "_lon": 120.585205, "dist_km": 0.155, "_elev": 218.0, "time": "2025-08-27 10:34:11", "elevation": 218.0, "power": 347.0, "cadence1": null, "cadence2": 91.5, "speed": 14.85, "gradient": 9.53, "distance": 155.0, "motor": "126", "main_ib": "14700", "torque": 25.0, "level": 3.0}, {"_lat": 24.199903, "_lon": 120.585236, "dist_km": 0.16, "_elev": 218.2, "time": "2025-08-27 10:34:12", "elevation": 218.2, "power": 352.0, "cadence1": null, "cadence2": 91.5, "speed": 14.68, "gradient": 4.77, "distance": 160.0, "motor": "128", "main_ib": "17300", "torque": 27.3, "level": 3.0}, {"_lat": 24.199881, "_lon": 120.585269, "dist_km": 0.164, "_elev": 218.4, "time": "2025-08-27 10:34:13", "elevation": 218.4, "power": 321.0, "cadence1": null, "cadence2": 92.5, "speed": 14.54, "gradient": 4.82, "distance": 164.0, "motor": "128", "main_ib": "16800", "torque": 20.9, "level": 3.0}, {"_lat": 24.19986, "_lon": 120.585303, "dist_km": 0.168, "_elev": 218.8, "time": "2025-08-27 10:34:14", "elevation": 218.8, "power": 333.0, "cadence1": null, "cadence2": 93.0, "speed": 14.51, "gradient": 9.6, "distance": 168.0, "motor": "129", "main_ib": "16700", "torque": 10.799999999999999, "level": 3.0}, {"_lat": 24.199843, "_lon": 120.58534, "dist_km": 0.172, "_elev": 219.4, "time": "2025-08-27 10:34:15", "elevation": 219.4, "power": 363.0, "cadence1": null, "cadence2": 91.5, "speed": 14.71, "gradient": 14.28, "distance": 172.0, "motor": "130", "main_ib": "17500", "torque": 23.25, "level": 3.0}, {"_lat": 24.199825, "_lon": 120.58538, "dist_km": 0.177, "_elev": 219.8, "time": "2025-08-27 10:34:16", "elevation": 219.8, "power": 349.0, "cadence1": null, "cadence2": 91.5, "speed": 14.98, "gradient": 8.84, "distance": 177.0, "motor": "130", "main_ib": "15600", "torque": 24.1, "level": 3.0}, {"_lat": 24.199807, "_lon": 120.585416, "dist_km": 0.181, "_elev": 220.2, "time": "2025-08-27 10:34:17", "elevation": 220.2, "power": 355.0, "cadence1": null, "cadence2": 89.5, "speed": 14.58, "gradient": 9.61, "distance": 181.0, "motor": "131", "main_ib": "16200", "torque": 18.85, "level": 3.0}, {"_lat": 24.199789, "_lon": 120.585451, "dist_km": 0.185, "_elev": 220.6, "time": "2025-08-27 10:34:18", "elevation": 220.6, "power": 337.0, "cadence1": null, "cadence2": 91.0, "speed": 14.68, "gradient": 9.82, "distance": 185.0, "motor": "132", "main_ib": "14700", "torque": 16.8, "level": 3.0}, {"_lat": 24.199774, "_lon": 120.585486, "dist_km": 0.189, "_elev": 221.0, "time": "2025-08-27 10:34:19", "elevation": 221.0, "power": 338.0, "cadence1": null, "cadence2": 91.0, "speed": 14.58, "gradient": 10.2, "distance": 189.0, "motor": "132", "main_ib": "14600", "torque": 12.35, "level": 3.0}, {"_lat": 24.199755, "_lon": 120.585522, "dist_km": 0.193, "_elev": 221.4, "time": "2025-08-27 10:34:20", "elevation": 221.4, "power": 338.0, "cadence1": null, "cadence2": 87.5, "speed": 14.51, "gradient": 9.48, "distance": 193.0, "motor": "132", "main_ib": "13000", "torque": 12.55, "level": 3.0}, {"_lat": 24.199738, "_lon": 120.585556, "dist_km": 0.197, "_elev": 221.8, "time": "2025-08-27 10:34:21", "elevation": 221.8, "power": 327.0, "cadence1": null, "cadence2": 92.5, "speed": 14.38, "gradient": 10.17, "distance": 197.0, "motor": "134", "main_ib": "12800", "torque": 19.3, "level": 3.0}, {"_lat": 24.199719, "_lon": 120.585587, "dist_km": 0.201, "_elev": 222.2, "time": "2025-08-27 10:34:22", "elevation": 222.2, "power": 330.0, "cadence1": null, "cadence2": 95.0, "speed": 14.34, "gradient": 10.56, "distance": 201.0, "motor": "134", "main_ib": "13400", "torque": 23.4, "level": 3.0}, {"_lat": 24.199701, "_lon": 120.585627, "dist_km": 0.205, "_elev": 222.6, "time": "2025-08-27 10:34:23", "elevation": 222.6, "power": 311.0, "cadence1": null, "cadence2": 94.0, "speed": 15.05, "gradient": 8.84, "distance": 205.0, "motor": "134", "main_ib": "12800", "torque": 13.75, "level": 3.0}, {"_lat": 24.199686, "_lon": 120.58566, "dist_km": 0.209, "_elev": 222.8, "time": "2025-08-27 10:34:24", "elevation": 222.8, "power": 340.0, "cadence1": null, "cadence2": 94.0, "speed": 14.64, "gradient": 5.35, "distance": 209.0, "motor": "134", "main_ib": "13500", "torque": 25.9, "level": 3.0}, {"_lat": 24.199669, "_lon": 120.585693, "dist_km": 0.213, "_elev": 223.2, "time": "2025-08-27 10:34:25", "elevation": 223.2, "power": 335.0, "cadence1": null, "cadence2": 91.5, "speed": 14.78, "gradient": 10.41, "distance": 213.0, "motor": "134", "main_ib": "13400", "torque": 18.05, "level": 3.0}, {"_lat": 24.199654, "_lon": 120.585721, "dist_km": 0.216, "_elev": 223.6, "time": "2025-08-27 10:34:26", "elevation": 223.6, "power": 359.0, "cadence1": null, "cadence2": 91.0, "speed": 14.64, "gradient": 12.15, "distance": 216.0, "motor": "134", "main_ib": "13500", "torque": 19.0, "level": 3.0}, {"_lat": 24.199635, "_lon": 120.585757, "dist_km": 0.22, "_elev": 224.2, "time": "2025-08-27 10:34:27", "elevation": 224.2, "power": 357.0, "cadence1": null, "cadence2": 89.0, "speed": 13.91, "gradient": 14.22, "distance": 220.0, "motor": "134", "main_ib": "13500", "torque": 20.05, "level": 3.0}, {"_lat": 24.199616, "_lon": 120.585793, "dist_km": 0.224, "_elev": 224.6, "time": "2025-08-27 10:34:28", "elevation": 224.6, "power": 370.0, "cadence1": null, "cadence2": 90.0, "speed": 13.4, "gradient": 9.48, "distance": 224.0, "motor": "134", "main_ib": "13500", "torque": 24.7, "level": 3.0}, {"_lat": 24.199598, "_lon": 120.585828, "dist_km": 0.228, "_elev": 225.0, "time": "2025-08-27 10:34:29", "elevation": 225.0, "power": 318.0, "cadence1": null, "cadence2": 92.5, "speed": 14.24, "gradient": 9.82, "distance": 228.0, "motor": "134", "main_ib": "13500", "torque": 27.35, "level": 3.0}, {"_lat": 24.199578, "_lon": 120.585863, "dist_km": 0.233, "_elev": 225.4, "time": "2025-08-27 10:34:30", "elevation": 225.4, "power": 363.0, "cadence1": null, "cadence2": 96.5, "speed": 14.44, "gradient": 9.55, "distance": 233.0, "motor": "136", "main_ib": "13500", "torque": 15.850000000000001, "level": 3.0}, {"_lat": 24.199557, "_lon": 120.585898, "dist_km": 0.237, "_elev": 225.6, "time": "2025-08-27 10:34:31", "elevation": 225.6, "power": 386.0, "cadence1": null, "cadence2": 96.0, "speed": 14.71, "gradient": 4.71, "distance": 237.0, "motor": "136", "main_ib": "13400", "torque": 11.95, "level": 3.0}, {"_lat": 24.199536, "_lon": 120.585934, "dist_km": 0.241, "_elev": 226.0, "time": "2025-08-27 10:34:32", "elevation": 226.0, "power": 374.0, "cadence1": null, "cadence2": 96.0, "speed": 15.45, "gradient": 9.23, "distance": 241.0, "motor": "136", "main_ib": "13400", "torque": 14.85, "level": 3.0}, {"_lat": 24.199512, "_lon": 120.585966, "dist_km": 0.245, "_elev": 226.2, "time": "2025-08-27 10:34:33", "elevation": 226.2, "power": 374.0, "cadence1": null, "cadence2": 95.5, "speed": 15.45, "gradient": 4.76, "distance": 245.0, "motor": "136", "main_ib": "12100", "torque": 19.7, "level": 3.0}, {"_lat": 24.199487, "_lon": 120.586003, "dist_km": 0.25, "_elev": 226.6, "time": "2025-08-27 10:34:34", "elevation": 226.6, "power": 397.0, "cadence1": null, "cadence2": 93.5, "speed": 15.55, "gradient": 8.57, "distance": 250.0, "motor": "136", "main_ib": "13400", "torque": 19.75, "level": 3.0}, {"_lat": 24.19946, "_lon": 120.586037, "dist_km": 0.255, "_elev": 227.2, "time": "2025-08-27 10:34:35", "elevation": 227.2, "power": 339.0, "cadence1": null, "cadence2": 91.5, "speed": 15.12, "gradient": 13.12, "distance": 255.0, "motor": "136", "main_ib": "13200", "torque": 26.05, "level": 3.0}, {"_lat": 24.199432, "_lon": 120.586067, "dist_km": 0.259, "_elev": 227.6, "time": "2025-08-27 10:34:36", "elevation": 227.6, "power": 303.0, "cadence1": null, "cadence2": 90.0, "speed": 14.91, "gradient": 9.19, "distance": 259.0, "motor": "136", "main_ib": "13300", "torque": 20.4, "level": 3.0}, {"_lat": 24.199405, "_lon": 120.586095, "dist_km": 0.263, "_elev": 227.8, "time": "2025-08-27 10:34:37", "elevation": 227.8, "power": 342.0, "cadence1": null, "cadence2": 88.0, "speed": 14.61, "gradient": 4.84, "distance": 263.0, "motor": "136", "main_ib": "13500", "torque": 22.8, "level": 3.0}, {"_lat": 24.19938, "_lon": 120.586127, "dist_km": 0.268, "_elev": 228.4, "time": "2025-08-27 10:34:38", "elevation": 228.4, "power": 318.0, "cadence1": null, "cadence2": 90.0, "speed": 14.34, "gradient": 14.04, "distance": 268.0, "motor": "136", "main_ib": "13400", "torque": 17.4, "level": 3.0}, {"_lat": 24.199355, "_lon": 120.586156, "dist_km": 0.272, "_elev": 228.8, "time": "2025-08-27 10:34:39", "elevation": 228.8, "power": 371.0, "cadence1": null, "cadence2": 91.0, "speed": 14.28, "gradient": 9.88, "distance": 272.0, "motor": "136", "main_ib": "13500", "torque": 21.25, "level": 3.0}, {"_lat": 24.199331, "_lon": 120.586183, "dist_km": 0.276, "_elev": 229.0, "time": "2025-08-27 10:34:40", "elevation": 229.0, "power": 368.0, "cadence1": null, "cadence2": 91.0, "speed": 14.14, "gradient": 5.23, "distance": 276.0, "motor": "136", "main_ib": "13100", "torque": 19.7, "level": 3.0}, {"_lat": 24.199306, "_lon": 120.58621, "dist_km": 0.279, "_elev": 229.6, "time": "2025-08-27 10:34:41", "elevation": 229.6, "power": 355.0, "cadence1": null, "cadence2": 91.5, "speed": 14.44, "gradient": 15.38, "distance": 279.0, "motor": "137", "main_ib": "13500", "torque": 20.299999999999997, "level": 3.0}, {"_lat": 24.199282, "_lon": 120.58624, "dist_km": 0.284, "_elev": 230.0, "time": "2025-08-27 10:34:42", "elevation": 230.0, "power": 347.0, "cadence1": null, "cadence2": 92.0, "speed": 14.31, "gradient": 9.88, "distance": 284.0, "motor": "137", "main_ib": "13100", "torque": 20.099999999999998, "level": 3.0}, {"_lat": 24.199258, "_lon": 120.586268, "dist_km": 0.287, "_elev": 230.4, "time": "2025-08-27 10:34:43", "elevation": 230.4, "power": 364.0, "cadence1": null, "cadence2": 92.0, "speed": 14.34, "gradient": 10.26, "distance": 287.0, "motor": "136", "main_ib": "13500", "torque": 21.9, "level": 3.0}, {"_lat": 24.19923, "_lon": 120.586295, "dist_km": 0.291, "_elev": 231.0, "time": "2025-08-27 10:34:44", "elevation": 231.0, "power": 354.0, "cadence1": null, "cadence2": 92.5, "speed": 13.98, "gradient": 14.47, "distance": 291.0, "motor": "138", "main_ib": "13500", "torque": 16.5, "level": 3.0}, {"_lat": 24.199204, "_lon": 120.586323, "dist_km": 0.296, "_elev": 231.4, "time": "2025-08-27 10:34:45", "elevation": 231.4, "power": 393.0, "cadence1": null, "cadence2": 94.5, "speed": 14.11, "gradient": 9.87, "distance": 296.0, "motor": "138", "main_ib": "12400", "torque": 19.45, "level": 3.0}, {"_lat": 24.199179, "_lon": 120.586351, "dist_km": 0.299, "_elev": 231.6, "time": "2025-08-27 10:34:46", "elevation": 231.6, "power": 353.0, "cadence1": null, "cadence2": 97.0, "speed": 13.87, "gradient": 5.03, "distance": 299.0, "motor": "138", "main_ib": "13500", "torque": 13.25, "level": 3.0}, {"_lat": 24.199154, "_lon": 120.586378, "dist_km": 0.303, "_elev": 232.0, "time": "2025-08-27 10:34:47", "elevation": 232.0, "power": 362.0, "cadence1": null, "cadence2": 99.0, "speed": 13.87, "gradient": 10.25, "distance": 303.0, "motor": "138", "main_ib": "12200", "torque": 10.4, "level": 3.0}, {"_lat": 24.199127, "_lon": 120.586406, "dist_km": 0.307, "_elev": 232.4, "time": "2025-08-27 10:34:48", "elevation": 232.4, "power": 362.0, "cadence1": null, "cadence2": 97.0, "speed": 14.24, "gradient": 9.68, "distance": 307.0, "motor": "138", "main_ib": "12100", "torque": 22.45, "level": 3.0}, {"_lat": 24.199098, "_lon": 120.586436, "dist_km": 0.312, "_elev": 232.8, "time": "2025-08-27 10:34:49", "elevation": 232.8, "power": 364.0, "cadence1": null, "cadence2": 98.5, "speed": 14.31, "gradient": 9.02, "distance": 312.0, "motor": "138", "main_ib": "10600", "torque": 10.5, "level": 3.0}, {"_lat": 24.19907, "_lon": 120.586462, "dist_km": 0.316, "_elev": 233.0, "time": "2025-08-27 10:34:50", "elevation": 233.0, "power": 366.0, "cadence1": null, "cadence2": 96.0, "speed": 15.05, "gradient": 4.9, "distance": 316.0, "motor": "138", "main_ib": "12600", "torque": 11.5, "level": 3.0}, {"_lat": 24.199041, "_lon": 120.586492, "dist_km": 0.32, "_elev": 233.4, "time": "2025-08-27 10:34:51", "elevation": 233.4, "power": 370.0, "cadence1": null, "cadence2": 96.0, "speed": 15.48, "gradient": 9.02, "distance": 320.0, "motor": "138", "main_ib": "13500", "torque": 12.05, "level": 3.0}, {"_lat": 24.199014, "_lon": 120.586517, "dist_km": 0.324, "_elev": 233.6, "time": "2025-08-27 10:34:52", "elevation": 233.6, "power": 371.0, "cadence1": null, "cadence2": 97.5, "speed": 14.18, "gradient": 5.09, "distance": 324.0, "motor": "138", "main_ib": "11300", "torque": 19.9, "level": 3.0}, {"_lat": 24.198988, "_lon": 120.586549, "dist_km": 0.328, "_elev": 234.0, "time": "2025-08-27 10:34:53", "elevation": 234.0, "power": 354.0, "cadence1": null, "cadence2": 97.5, "speed": 14.85, "gradient": 9.2, "distance": 328.0, "motor": "138", "main_ib": "11100", "torque": 8.65, "level": 3.0}, {"_lat": 24.198963, "_lon": 120.586576, "dist_km": 0.332, "_elev": 234.2, "time": "2025-08-27 10:34:54", "elevation": 234.2, "power": 355.0, "cadence1": null, "cadence2": 96.5, "speed": 13.67, "gradient": 5.13, "distance": 332.0, "motor": "139", "main_ib": "11400", "torque": 21.15, "level": 3.0}, {"_lat": 24.198938, "_lon": 120.586607, "dist_km": 0.336, "_elev": 234.6, "time": "2025-08-27 10:34:55", "elevation": 234.6, "power": 357.0, "cadence1": null, "cadence2": 95.5, "speed": 14.18, "gradient": 9.53, "distance": 336.0, "motor": "138", "main_ib": "12600", "torque": 19.3, "level": 3.0}, {"_lat": 24.198913, "_lon": 120.58664, "dist_km": 0.341, "_elev": 235.0, "time": "2025-08-27 10:34:56", "elevation": 235.0, "power": 322.0, "cadence1": null, "cadence2": 95.5, "speed": 14.14, "gradient": 9.19, "distance": 341.0, "motor": "140", "main_ib": "9600", "torque": 15.25, "level": 3.0}, {"_lat": 24.198885, "_lon": 120.586673, "dist_km": 0.345, "_elev": 235.2, "time": "2025-08-27 10:34:57", "elevation": 235.2, "power": 359.0, "cadence1": null, "cadence2": 97.5, "speed": 14.64, "gradient": 4.38, "distance": 345.0, "motor": "139", "main_ib": "10700", "torque": 7.75, "level": 3.0}, {"_lat": 24.198858, "_lon": 120.586704, "dist_km": 0.35, "_elev": 235.6, "time": "2025-08-27 10:34:58", "elevation": 235.6, "power": 340.0, "cadence1": null, "cadence2": 101.5, "speed": 15.25, "gradient": 9.2, "distance": 350.0, "motor": "140", "main_ib": "8600", "torque": 11.85, "level": 3.0}, {"_lat": 24.19883, "_lon": 120.586733, "dist_km": 0.354, "_elev": 235.8, "time": "2025-08-27 10:34:59", "elevation": 235.8, "power": 334.0, "cadence1": null, "cadence2": 103.0, "speed": 14.81, "gradient": 4.67, "distance": 354.0, "motor": "138", "main_ib": "9300", "torque": 10.55, "level": 3.0}, {"_lat": 24.198803, "_lon": 120.586764, "dist_km": 0.358, "_elev": 236.2, "time": "2025-08-27 10:35:00", "elevation": 236.2, "power": 325.0, "cadence1": null, "cadence2": 98.0, "speed": 15.99, "gradient": 9.2, "distance": 358.0, "motor": "139", "main_ib": "8900", "torque": 11.3, "level": 3.0}, {"_lat": 24.198772, "_lon": 120.586798, "dist_km": 0.363, "_elev": 236.4, "time": "2025-08-27 10:35:01", "elevation": 236.4, "power": 367.0, "cadence1": null, "cadence2": 95.0, "speed": 15.45, "gradient": 4.1, "distance": 363.0, "motor": "138", "main_ib": "11700", "torque": 6.95, "level": 3.0}, {"_lat": 24.198746, "_lon": 120.586835, "dist_km": 0.368, "_elev": 236.6, "time": "2025-08-27 10:35:02", "elevation": 236.6, "power": 351.0, "cadence1": null, "cadence2": 97.5, "speed": 15.18, "gradient": 4.22, "distance": 368.0, "motor": "138", "main_ib": "12600", "torque": 15.850000000000001, "level": 3.0}, {"_lat": 24.198721, "_lon": 120.58687, "dist_km": 0.372, "_elev": 237.0, "time": "2025-08-27 10:35:03", "elevation": 237.0, "power": 320.0, "cadence1": null, "cadence2": 95.5, "speed": 15.15, "gradient": 8.87, "distance": 372.0, "motor": "138", "main_ib": "10400", "torque": 11.4, "level": 3.0}, {"_lat": 24.198696, "_lon": 120.586901, "dist_km": 0.377, "_elev": 237.2, "time": "2025-08-27 10:35:04", "elevation": 237.2, "power": 331.0, "cadence1": null, "cadence2": 94.5, "speed": 14.85, "gradient": 4.77, "distance": 377.0, "motor": "138", "main_ib": "10000", "torque": 12.899999999999999, "level": 3.0}, {"_lat": 24.198669, "_lon": 120.586932, "dist_km": 0.381, "_elev": 237.4, "time": "2025-08-27 10:35:05", "elevation": 237.4, "power": 334.0, "cadence1": null, "cadence2": 94.5, "speed": 15.15, "gradient": 4.6, "distance": 381.0, "motor": "138", "main_ib": "11300", "torque": 14.149999999999999, "level": 3.0}, {"_lat": 24.198641, "_lon": 120.586963, "dist_km": 0.385, "_elev": 237.6, "time": "2025-08-27 10:35:06", "elevation": 237.6, "power": 342.0, "cadence1": null, "cadence2": 90.5, "speed": 14.91, "gradient": 4.52, "distance": 385.0, "motor": "138", "main_ib": "11300", "torque": 22.25, "level": 3.0}, {"_lat": 24.198612, "_lon": 120.586995, "dist_km": 0.39, "_elev": 238.0, "time": "2025-08-27 10:35:07", "elevation": 238.0, "power": 349.0, "cadence1": null, "cadence2": 91.5, "speed": 15.22, "gradient": 8.74, "distance": 390.0, "motor": "138", "main_ib": "12900", "torque": 12.100000000000001, "level": 3.0}, {"_lat": 24.198585, "_lon": 120.587023, "dist_km": 0.394, "_elev": 238.4, "time": "2025-08-27 10:35:08", "elevation": 238.4, "power": 317.0, "cadence1": null, "cadence2": 91.0, "speed": 14.68, "gradient": 9.68, "distance": 394.0, "motor": "138", "main_ib": "13500", "torque": 26.7, "level": 3.0}, {"_lat": 24.198558, "_lon": 120.587053, "dist_km": 0.398, "_elev": 238.8, "time": "2025-08-27 10:35:09", "elevation": 238.8, "power": 341.0, "cadence1": null, "cadence2": 90.0, "speed": 14.34, "gradient": 9.36, "distance": 398.0, "motor": "138", "main_ib": "13400", "torque": 20.2, "level": 3.0}, {"_lat": 24.198532, "_lon": 120.587085, "dist_km": 0.403, "_elev": 239.0, "time": "2025-08-27 10:35:10", "elevation": 239.0, "power": 330.0, "cadence1": null, "cadence2": 91.5, "speed": 14.61, "gradient": 4.6, "distance": 403.0, "motor": "137", "main_ib": "13300", "torque": 15.5, "level": 3.0}, {"_lat": 24.19851, "_lon": 120.587113, "dist_km": 0.407, "_elev": 239.4, "time": "2025-08-27 10:35:11", "elevation": 239.4, "power": 359.0, "cadence1": null, "cadence2": 91.0, "speed": 14.51, "gradient": 10.67, "distance": 407.0, "motor": "138", "main_ib": "13400", "torque": 13.45, "level": 3.0}, {"_lat": 24.198485, "_lon": 120.587141, "dist_km": 0.411, "_elev": 239.6, "time": "2025-08-27 10:35:12", "elevation": 239.6, "power": 342.0, "cadence1": null, "cadence2": 90.0, "speed": 14.58, "gradient": 5.03, "distance": 411.0, "motor": "137", "main_ib": "13500", "torque": 24.75, "level": 3.0}, {"_lat": 24.19846, "_lon": 120.587169, "dist_km": 0.415, "_elev": 240.2, "time": "2025-08-27 10:35:13", "elevation": 240.2, "power": 342.0, "cadence1": null, "cadence2": 88.5, "speed": 14.41, "gradient": 15.1, "distance": 415.0, "motor": "138", "main_ib": "13300", "torque": 23.25, "level": 3.0}, {"_lat": 24.198437, "_lon": 120.587196, "dist_km": 0.418, "_elev": 240.6, "time": "2025-08-27 10:35:14", "elevation": 240.6, "power": 336.0, "cadence1": null, "cadence2": 88.0, "speed": 14.31, "gradient": 10.68, "distance": 418.0, "motor": "138", "main_ib": "13300", "torque": 8.65, "level": 3.0}, {"_lat": 24.198415, "_lon": 120.587225, "dist_km": 0.422, "_elev": 240.8, "time": "2025-08-27 10:35:15", "elevation": 240.8, "power": 322.0, "cadence1": null, "cadence2": 85.5, "speed": 14.14, "gradient": 5.23, "distance": 422.0, "motor": "138", "main_ib": "13200", "torque": 22.7, "level": 3.0}, {"_lat": 24.19839, "_lon": 120.587255, "dist_km": 0.426, "_elev": 241.2, "time": "2025-08-27 10:35:16", "elevation": 241.2, "power": 315.0, "cadence1": null, "cadence2": 86.0, "speed": 13.94, "gradient": 9.71, "distance": 426.0, "motor": "138", "main_ib": "13100", "torque": 22.55, "level": 3.0}, {"_lat": 24.19836, "_lon": 120.587284, "dist_km": 0.431, "_elev": 241.6, "time": "2025-08-27 10:35:17", "elevation": 241.6, "power": 305.0, "cadence1": null, "cadence2": 84.0, "speed": 13.81, "gradient": 8.99, "distance": 431.0, "motor": "138", "main_ib": "13500", "torque": 20.6, "level": 3.0}, {"_lat": 24.198332, "_lon": 120.587308, "dist_km": 0.435, "_elev": 242.0, "time": "2025-08-27 10:35:18", "elevation": 242.0, "power": 277.0, "cadence1": null, "cadence2": 85.5, "speed": 13.71, "gradient": 10.12, "distance": 435.0, "motor": "138", "main_ib": "13400", "torque": 19.55, "level": 3.0}, {"_lat": 24.198306, "_lon": 120.587334, "dist_km": 0.439, "_elev": 242.4, "time": "2025-08-27 10:35:19", "elevation": 242.4, "power": 321.0, "cadence1": null, "cadence2": 85.5, "speed": 13.57, "gradient": 10.22, "distance": 439.0, "motor": "138", "main_ib": "13600", "torque": 28.950000000000003, "level": 3.0}, {"_lat": 24.198283, "_lon": 120.587359, "dist_km": 0.442, "_elev": 242.8, "time": "2025-08-27 10:35:20", "elevation": 242.8, "power": 313.0, "cadence1": null, "cadence2": 84.0, "speed": 13.64, "gradient": 11.11, "distance": 442.0, "motor": "138", "main_ib": "13500", "torque": 20.4, "level": 3.0}, {"_lat": 24.198265, "_lon": 120.587389, "dist_km": 0.446, "_elev": 243.2, "time": "2025-08-27 10:35:21", "elevation": 243.2, "power": 331.0, "cadence1": null, "cadence2": 87.0, "speed": 13.47, "gradient": 10.98, "distance": 446.0, "motor": "138", "main_ib": "13500", "torque": 20.9, "level": 3.0}, {"_lat": 24.19825, "_lon": 120.587426, "dist_km": 0.45, "_elev": 243.4, "time": "2025-08-27 10:35:22", "elevation": 243.4, "power": 363.0, "cadence1": null, "cadence2": 86.5, "speed": 13.2, "gradient": 4.87, "distance": 450.0, "motor": "138", "main_ib": "13400", "torque": 16.15, "level": 3.0}, {"_lat": 24.198245, "_lon": 120.587467, "dist_km": 0.454, "_elev": 243.8, "time": "2025-08-27 10:35:23", "elevation": 243.8, "power": 351.0, "cadence1": null, "cadence2": 86.0, "speed": 13.6, "gradient": 9.53, "distance": 454.0, "motor": "138", "main_ib": "13300", "torque": 20.95, "level": 3.0}, {"_lat": 24.198249, "_lon": 120.587506, "dist_km": 0.458, "_elev": 244.2, "time": "2025-08-27 10:35:24", "elevation": 244.2, "power": 346.0, "cadence1": null, "cadence2": 85.5, "speed": 13.81, "gradient": 10.05, "distance": 458.0, "motor": "140", "main_ib": "13500", "torque": 29.150000000000002, "level": 3.0}, {"_lat": 24.198258, "_lon": 120.58754, "dist_km": 0.461, "_elev": 244.6, "time": "2025-08-27 10:35:25", "elevation": 244.6, "power": 327.0, "cadence1": null, "cadence2": 86.0, "speed": 13.54, "gradient": 11.14, "distance": 461.0, "motor": "140", "main_ib": "13500", "torque": 23.8, "level": 3.0}, {"_lat": 24.198269, "_lon": 120.587575, "dist_km": 0.465, "_elev": 245.2, "time": "2025-08-27 10:35:26", "elevation": 245.2, "power": 313.0, "cadence1": null, "cadence2": 86.0, "speed": 13.4, "gradient": 15.98, "distance": 465.0, "motor": "140", "main_ib": "13500", "torque": 21.65, "level": 3.0}, {"_lat": 24.198278, "_lon": 120.587614, "dist_km": 0.469, "_elev": 245.4, "time": "2025-08-27 10:35:27", "elevation": 245.4, "power": 328.0, "cadence1": null, "cadence2": 86.5, "speed": 13.64, "gradient": 4.9, "distance": 469.0, "motor": "140", "main_ib": "13500", "torque": 26.900000000000002, "level": 3.0}, {"_lat": 24.198287, "_lon": 120.587652, "dist_km": 0.473, "_elev": 245.8, "time": "2025-08-27 10:35:28", "elevation": 245.8, "power": 322.0, "cadence1": null, "cadence2": 86.0, "speed": 13.6, "gradient": 10.05, "distance": 473.0, "motor": "140", "main_ib": "13300", "torque": 18.3, "level": 3.0}, {"_lat": 24.198298, "_lon": 120.587689, "dist_km": 0.477, "_elev": 246.2, "time": "2025-08-27 10:35:29", "elevation": 246.2, "power": 320.0, "cadence1": null, "cadence2": 86.5, "speed": 13.91, "gradient": 10.13, "distance": 477.0, "motor": "140", "main_ib": "12500", "torque": 24.8, "level": 3.0}, {"_lat": 24.198311, "_lon": 120.587727, "dist_km": 0.481, "_elev": 246.6, "time": "2025-08-27 10:35:30", "elevation": 246.6, "power": 348.0, "cadence1": null, "cadence2": 85.0, "speed": 13.91, "gradient": 9.72, "distance": 481.0, "motor": "140", "main_ib": "11600", "torque": 20.7, "level": 3.0}, {"_lat": 24.198322, "_lon": 120.587762, "dist_km": 0.485, "_elev": 247.0, "time": "2025-08-27 10:35:31", "elevation": 247.0, "power": 315.0, "cadence1": null, "cadence2": 84.5, "speed": 13.74, "gradient": 10.65, "distance": 485.0, "motor": "142", "main_ib": "10700", "torque": 17.299999999999997, "level": 3.0}, {"_lat": 24.198331, "_lon": 120.587797, "dist_km": 0.489, "_elev": 247.4, "time": "2025-08-27 10:35:32", "elevation": 247.4, "power": 326.0, "cadence1": null, "cadence2": 82.5, "speed": 13.57, "gradient": 10.85, "distance": 489.0, "motor": "140", "main_ib": "9700", "torque": 29.7, "level": 3.0}, {"_lat": 24.198343, "_lon": 120.587833, "dist_km": 0.493, "_elev": 247.8, "time": "2025-08-27 10:35:33", "elevation": 247.8, "power": 330.0, "cadence1": null, "cadence2": 83.5, "speed": 13.57, "gradient": 10.29, "distance": 493.0, "motor": "141", "main_ib": "9000", "torque": 37.4, "level": 3.0}, {"_lat": 24.198356, "_lon": 120.58787, "dist_km": 0.497, "_elev": 248.2, "time": "2025-08-27 10:35:34", "elevation": 248.2, "power": 331.0, "cadence1": null, "cadence2": 81.5, "speed": 13.3, "gradient": 9.95, "distance": 497.0, "motor": "141", "main_ib": "9100", "torque": 36.55, "level": 3.0}, {"_lat": 24.198367, "_lon": 120.587903, "dist_km": 0.5, "_elev": 248.6, "time": "2025-08-27 10:35:35", "elevation": 248.6, "power": 381.0, "cadence1": null, "cadence2": 78.5, "speed": 13.13, "gradient": 11.22, "distance": 500.0, "motor": "141", "main_ib": "8800", "torque": 23.1, "level": 3.0}, {"_lat": 24.19838, "_lon": 120.587936, "dist_km": 0.504, "_elev": 249.0, "time": "2025-08-27 10:35:36", "elevation": 249.0, "power": 352.0, "cadence1": null, "cadence2": 79.5, "speed": 13.07, "gradient": 10.97, "distance": 504.0, "motor": "141", "main_ib": "8900", "torque": 22.4, "level": 3.0}, {"_lat": 24.198391, "_lon": 120.587967, "dist_km": 0.507, "_elev": 249.6, "time": "2025-08-27 10:35:37", "elevation": 249.6, "power": 320.0, "cadence1": null, "cadence2": 78.5, "speed": 12.8, "gradient": 17.78, "distance": 507.0, "motor": "141", "main_ib": "9000", "torque": 37.1, "level": 3.0}, {"_lat": 24.198401, "_lon": 120.588003, "dist_km": 0.511, "_elev": 249.8, "time": "2025-08-27 10:35:38", "elevation": 249.8, "power": 296.0, "cadence1": null, "cadence2": 75.5, "speed": 12.66, "gradient": 5.24, "distance": 511.0, "motor": "142", "main_ib": "9000", "torque": 16.9, "level": 3.0}, {"_lat": 24.198415, "_lon": 120.588035, "dist_km": 0.515, "_elev": 250.4, "time": "2025-08-27 10:35:39", "elevation": 250.4, "power": 331.0, "cadence1": null, "cadence2": 76.0, "speed": 12.46, "gradient": 16.67, "distance": 515.0, "motor": "142", "main_ib": "8900", "torque": 17.7, "level": 3.0}, {"_lat": 24.198426, "_lon": 120.588063, "dist_km": 0.518, "_elev": 250.8, "time": "2025-08-27 10:35:40", "elevation": 250.8, "power": 301.0, "cadence1": null, "cadence2": 83.0, "speed": 12.19, "gradient": 12.94, "distance": 518.0, "motor": "143", "main_ib": "9000", "torque": 14.45, "level": 3.0}, {"_lat": 24.198441, "_lon": 120.588094, "dist_km": 0.521, "_elev": 251.0, "time": "2025-08-27 10:35:41", "elevation": 251.0, "power": 289.0, "cadence1": null, "cadence2": 92.0, "speed": 12.33, "gradient": 5.62, "distance": 521.0, "motor": "144", "main_ib": "8500", "torque": 2.75, "level": 3.0}, {"_lat": 24.198454, "_lon": 120.588127, "dist_km": 0.525, "_elev": 251.4, "time": "2025-08-27 10:35:42", "elevation": 251.4, "power": 245.0, "cadence1": null, "cadence2": 97.5, "speed": 13.54, "gradient": 10.97, "distance": 525.0, "motor": "144", "main_ib": "8800", "torque": 0.8, "level": 3.0}, {"_lat": 24.198465, "_lon": 120.588165, "dist_km": 0.529, "_elev": 251.8, "time": "2025-08-27 10:35:43", "elevation": 251.8, "power": 240.0, "cadence1": null, "cadence2": 102.5, "speed": 14.71, "gradient": 9.89, "distance": 529.0, "motor": "144", "main_ib": "8700", "torque": 5.5, "level": 3.0}, {"_lat": 24.198479, "_lon": 120.588205, "dist_km": 0.533, "_elev": 252.0, "time": "2025-08-27 10:35:44", "elevation": 252.0, "power": 264.0, "cadence1": null, "cadence2": 95.0, "speed": 15.79, "gradient": 4.6, "distance": 533.0, "motor": "144", "main_ib": "8400", "torque": 0.9, "level": 3.0}, {"_lat": 24.198495, "_lon": 120.58825, "dist_km": 0.538, "_elev": 252.2, "time": "2025-08-27 10:35:45", "elevation": 252.2, "power": 258.0, "cadence1": null, "cadence2": 82.5, "speed": 16.63, "gradient": 4.08, "distance": 538.0, "motor": "143", "main_ib": "7100", "torque": 13.8, "level": 3.0}, {"_lat": 24.198509, "_lon": 120.588293, "dist_km": 0.543, "_elev": 252.4, "time": "2025-08-27 10:35:46", "elevation": 252.4, "power": 229.0, "cadence1": null, "cadence2": 77.0, "speed": 15.99, "gradient": 4.32, "distance": 543.0, "motor": "142", "main_ib": "8900", "torque": 19.05, "level": 3.0}, {"_lat": 24.19852, "_lon": 120.588331, "dist_km": 0.547, "_elev": 252.4, "time": "2025-08-27 10:35:47", "elevation": 252.4, "power": 163.0, "cadence1": null, "cadence2": 72.0, "speed": 13.84, "gradient": 0.0, "distance": 547.0, "motor": "142", "main_ib": "8900", "torque": 21.2, "level": 3.0}, {"_lat": 24.198531, "_lon": 120.588364, "dist_km": 0.551, "_elev": 252.6, "time": "2025-08-27 10:35:48", "elevation": 252.6, "power": 221.0, "cadence1": null, "cadence2": 68.0, "speed": 12.29, "gradient": 5.61, "distance": 551.0, "motor": "142", "main_ib": "9000", "torque": 1.25, "level": 3.0}, {"_lat": 24.198539, "_lon": 120.588394, "dist_km": 0.554, "_elev": 252.8, "time": "2025-08-27 10:35:49", "elevation": 252.8, "power": 229.0, "cadence1": null, "cadence2": 36.0, "speed": 11.72, "gradient": 6.31, "distance": 554.0, "motor": "144", "main_ib": "5600", "torque": 0.0, "level": 3.0}, {"_lat": 24.19855, "_lon": 120.588419, "dist_km": 0.557, "_elev": 253.2, "time": "2025-08-27 10:35:50", "elevation": 253.2, "power": 221.0, "cadence1": null, "cadence2": 0.0, "speed": 10.95, "gradient": 14.21, "distance": 557.0, "motor": "138", "main_ib": "0", "torque": 0.0, "level": 3.0}, {"_lat": 24.198558, "_lon": 120.588443, "dist_km": 0.559, "_elev": 253.6, "time": "2025-08-27 10:35:51", "elevation": 253.6, "power": 119.0, "cadence1": null, "cadence2": 0.0, "speed": 9.64, "gradient": 15.43, "distance": 559.0, "motor": "138", "main_ib": "0", "torque": 0.0, "level": 3.0}, {"_lat": 24.198561, "_lon": 120.588463, "dist_km": 0.561, "_elev": 253.8, "time": "2025-08-27 10:35:52", "elevation": 253.8, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 7.46, "gradient": 9.73, "distance": 561.0, "motor": "135", "main_ib": "0", "torque": 22.0, "level": 3.0}, {"_lat": 24.198563, "_lon": 120.58848, "dist_km": 0.563, "_elev": 254.2, "time": "2025-08-27 10:35:53", "elevation": 254.2, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 5.34, "gradient": 23.01, "distance": 563.0, "motor": "134", "main_ib": "0", "torque": 21.85, "level": 3.0}, {"_lat": 24.198563, "_lon": 120.588487, "dist_km": 0.564, "_elev": 254.4, "time": "2025-08-27 10:35:54", "elevation": 254.4, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 1.21, "gradient": 28.17, "distance": 564.0, "motor": "134", "main_ib": "0", "torque": 22.2, "level": 3.0}, {"_lat": 24.198564, "_lon": 120.588489, "dist_km": 0.564, "_elev": 254.6, "time": "2025-08-27 10:35:55", "elevation": 254.6, "power": 0.0, "cadence1": null, "cadence2": 0.0, "speed": 0.0, "gradient": null, "distance": 564.0, "motor": "134", "main_ib": "0", "torque": 23.75, "level": 3.0}];

function fmt(v, n=2) { if(v===null||v===undefined||Number.isNaN(v)) return '—'; return (+v).toFixed(n); }
function fmtInt(v) { if(v===null||v===undefined||Number.isNaN(v)) return '—'; return Math.round(+v).toString(); }

const map = L.map('map', { zoomControl: true });
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19, attribution: '&copy; OpenStreetMap'
}).addTo(map);

const latlngs = POINTS.map(p => [p._lat, p._lon]).filter(x => x[0]!=null && x[1]!=null);
const line = L.polyline(latlngs, {color:'#0066cc', weight:3}).addTo(map);
if(latlngs.length) map.fitBounds(line.getBounds());
const cursor = latlngs.length ? L.circleMarker(latlngs[0], {radius:6, color:'#d62728', weight:2, fillColor:'#fff', fillOpacity:1}).addTo(map) : null;

// 建立透明 markers 讓地圖 hover 同步
const markers = L.layerGroup().addTo(map);
for(let i=0;i<POINTS.length;i++) {
  const p = POINTS[i];
  if(p._lat==null||p._lon==null) continue;
  const m = L.circleMarker([p._lat, p._lon], {radius:6, weight:0, fillOpacity:0});
  m.on('mouseover', ()=> updateByIndex(i));
  markers.addLayer(m);
}

const canvas = document.getElementById('elevCanvas');
const ctx = canvas.getContext('2d');
const DISTS = POINTS.map(p => p.dist_km ?? 0);
const ELEVS = POINTS.map(p => p._elev ?? 0);

function resizeCanvas(){
  const rect = canvas.parentElement.getBoundingClientRect();
  canvas.width = Math.max(1, rect.width * devicePixelRatio);
  canvas.height = Math.max(1, rect.height * devicePixelRatio);
  drawProfile();
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function drawProfile(highlightIndex = 0){
  const w = canvas.width, h = canvas.height;
  ctx.clearRect(0,0,w,h);
  if(DISTS.length===0) return;
  const minX = DISTS[0], maxX = DISTS[DISTS.length-1];
  const minY = Math.min(...ELEVS), maxY = Math.max(...ELEVS);
  function xScale(x){ return (x - minX) / (maxX - minX || 1) * (w*0.98) + (w*0.01); }
  function yScale(y){ return h*0.95 - (y - minY) / (maxY - minY || 1) * (h*0.85); }

  // x 軸
  ctx.lineWidth = 1*devicePixelRatio; ctx.strokeStyle = '#ddd';
  ctx.beginPath(); ctx.moveTo(xScale(minX), yScale(minY)); ctx.lineTo(xScale(maxX), yScale(minY)); ctx.stroke();

  // 線
  ctx.lineWidth = 2.5*devicePixelRatio; ctx.strokeStyle = '#0066cc';
  ctx.beginPath();
  for(let i=0;i<DISTS.length;i++){ const x=xScale(DISTS[i]), y=yScale(ELEVS[i]); i===0?ctx.moveTo(x,y):ctx.lineTo(x,y); }
  ctx.stroke();

  // 高亮
  const ix = Math.max(0, Math.min(highlightIndex, DISTS.length-1));
  const cx = xScale(DISTS[ix]), cy = yScale(ELEVS[ix]);
  ctx.strokeStyle = 'rgba(0,0,0,.25)'; ctx.lineWidth = 1*devicePixelRatio;
  ctx.beginPath(); ctx.moveTo(cx, yScale(minY)); ctx.lineTo(cx, yScale(maxY)); ctx.stroke();
  ctx.fillStyle = '#d62728'; ctx.beginPath(); ctx.arc(cx, cy, 4*devicePixelRatio, 0, Math.PI*2); ctx.fill();
}

function binarySearchNearest(arr, value){
  let lo=0, hi=arr.length-1;
  while(lo<hi){ const mid=(lo+hi)>>1; if(arr[mid] < value) lo=mid+1; else hi=mid; }
  if(lo>0 && Math.abs(arr[lo]-value) > Math.abs(arr[lo-1]-value)) return lo-1;
  return lo;
}

function updateByIndex(i){
  if(i<0 || i>=POINTS.length) return;
  const p = POINTS[i];
  if(cursor && p._lat!=null && p._lon!=null) cursor.setLatLng([p._lat, p._lon]);
  document.getElementById('v_time').textContent = p.time || '—';
  document.getElementById('v_elev').textContent = fmt(p.elevation,1);
  document.getElementById('v_power').textContent = fmt(p.power,0);
  document.getElementById('v_cad1').textContent = fmt(p.cadence1,0);
  document.getElementById('v_speed').textContent = fmt(p.speed,2);
  document.getElementById('v_grad').textContent = fmt(p.gradient,2);
  document.getElementById('v_dist').textContent = `${fmtInt(p.distance)} m (${fmt(p.dist_km,3)} km)`;
  document.getElementById('v_motor').textContent = (p.motor ?? '—');
  document.getElementById('v_mainib').textContent = (p.main_ib ?? '—');
  document.getElementById('v_torque').textContent = fmt(p.torque,1);
  document.getElementById('v_cad2').textContent = fmt(p.cadence2,0);
  document.getElementById('v_level').textContent = fmt(p.level,0);
  drawProfile(i);
}

canvas.addEventListener('mousemove', (ev)=>{
  const rect = canvas.getBoundingClientRect();
  const px = (ev.clientX - rect.left) * devicePixelRatio;
  const w = canvas.width;
  const minX = DISTS[0], maxX = DISTS[DISTS.length-1];
  const xVal = (px - w*0.01) / (w*0.98) * (maxX - minX) + minX;
  const i = binarySearchNearest(DISTS, xVal);
  updateByIndex(i);
});

// 初始
updateByIndex(0);
</script>
</body>
</html>
